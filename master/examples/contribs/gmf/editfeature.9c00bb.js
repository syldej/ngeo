(function(u){function e(e){var t=e[0];var r=e[1];var a=e[2];var n,i,o=0,l=[];for(;o<t.length;o++){i=t[o];if(h[i]){l.push(h[i][0])}h[i]=0}for(n in r){if(Object.prototype.hasOwnProperty.call(r,n)){u[n]=r[n]}}if(d)d(e);while(l.length){l.shift()()}f.push.apply(f,a||[]);return s()}function s(){var e;for(var t=0;t<f.length;t++){var r=f[t];var a=true;for(var n=1;n<r.length;n++){var i=r[n];if(h[i]!==0)a=false}if(a){f.splice(t--,1);e=o(o.s=r[0])}}return e}var r={};var h={8:0};var f=[];function o(e){if(r[e]){return r[e].exports}var t=r[e]={i:e,l:false,exports:{}};u[e].call(t.exports,t,t.exports,o);t.l=true;return t.exports}o.m=u;o.c=r;o.d=function(e,t,r){if(!o.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:r})}};o.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};o.t=function(t,e){if(e&1)t=o(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var r=Object.create(null);o.r(r);Object.defineProperty(r,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var a in t)o.d(r,a,function(e){return t[e]}.bind(null,a));return r};o.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};o.d(e,"a",e);return e};o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};o.p="";var t=window["webpackJsonp"]=window["webpackJsonp"]||[];var a=t.push.bind(t);t.push=e;t=t.slice();for(var n=0;n<t.length;n++)e(t[n]);var d=a;f.push([548,0]);return s()})({548:function(e,t,r){r(72);r(73);e.exports=r(549)},549:function(e,w,M){"use strict";M.r(w);(function(a){var n=M(32);var e=M(550);var t=M.n(e);var r=M(279);var i=M.n(r);var o=M(56);var l=M(189);var u=M(184);var s=M(55);var m=M(14);var h=M(34);var f=M(43);var g=M(3);var _=M(85);var d=M(28);var p=M(101);var c=M(49);var v=M(114);var y={};y.module=angular.module("gmfapp",["gettext",l["a"].name,u["a"].module.name,s["a"].name]);y.module.value("authenticationBaseUrl",n["a"].GMF_DEMO);y.module.value("gmfLayersUrl",n["a"].GMF_LAYERS);y.module.constant("defaultTheme","Demo");y.module.constant("angularLocaleScript","../build/angular-locale_{{locale}}.js");y.MainController=function(e,t,r){this.scope_=e;this.editFeature_=t;this.gmfUser=r;this.wmsSource_=new v["a"]({url:n["a"].MAPSERVER_PROXY,params:{LAYERS:"point"}});this.wmsLayer_=new p["a"]({source:this.wmsSource_});this.pixelBuffer_=10;this.layerId_=113;this.feature=null;this.pending=false;this.map=new h["a"]({layers:[new d["a"]({source:new c["a"]}),this.wmsLayer_],view:new f["a"]({projection:o["a"],resolutions:[200,100,50,20,10,5,2.5,2,1,.5],center:[537635,152640],zoom:2})});this.map.on("singleclick",this.handleMapSingleClick_.bind(this));a('[data-toggle="tooltip"]').tooltip({container:"body",trigger:"hover"})};y.MainController.$inject=["$scope","gmfEditFeature","gmfUser"];y.MainController.prototype.handleMapSingleClick_=function(e){var t=e.coordinate;var r=this.map;var a=r.getView();var n=a.getResolution();var i=n*this.pixelBuffer_;var o=g["c"]([t[0],t[1],t[0],t[1]],i);this.editFeature_.getFeaturesInExtent([this.layerId_],o).then(this.handleGetFeatures_.bind(this));this.feature=null;this.pending=true;this.scope_.$apply()};y.MainController.prototype.handleGetFeatures_=function(e){this.pending=false;if(e.length){this.feature=e[0]}};y.MainController.prototype.insertFeature=function(){this.pending=true;var e=this.map;var t=e.getView();var r=t.getResolution();var a=r*-50;var n=e.getSize();var i=g["c"](t.calculateExtent(n),a);var o=g["v"](i);var l=g["D"](i);var u=o[0];var s=o[1];var h=l[0];var f=l[1];var d=h-u;var p=f-s;var c=[u+Math.random()*d,s+Math.random()*p];var v=new m["a"]({geometry:new _["a"]([c]),name:"New point"});this.feature=null;this.editFeature_.insertFeatures(this.layerId_,[v]).then(this.handleEditFeature_.bind(this))};y.MainController.prototype.updateFeature=function(){console.assert(this.feature);this.pending=true;this.feature.set("name","Updated name");this.editFeature_.updateFeature(this.layerId_,this.feature).then(this.handleEditFeature_.bind(this))};y.MainController.prototype.deleteFeature=function(){console.assert(this.feature);this.editFeature_.deleteFeature(this.layerId_,this.feature).then(this.handleEditFeature_.bind(this));this.feature=null};y.MainController.prototype.handleEditFeature_=function(e){this.pending=false;this.refreshWMSLayer_()};y.MainController.prototype.refreshWMSLayer_=function(){this.wmsSource_.updateParams({random:Math.random()})};y.module.controller("MainController",y.MainController);w["default"]=y}).call(this,M(27))},550:function(e,t){}});
//# sourceMappingURL=editfeature.9c00bb.js.map