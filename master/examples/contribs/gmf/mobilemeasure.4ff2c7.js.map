{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./contribs/gmf/src/mobile/measure/lengthComponent.html","webpack:///./contribs/gmf/src/mobile/measure/pointComponent.html","webpack:///./src/interaction/MobileDraw.js","webpack:///./src/interaction/MeasureLengthMobile.js","webpack:///./contribs/gmf/src/mobile/measure/lengthComponent.js","webpack:///./src/interaction/MeasurePointMobile.js","webpack:///./contribs/gmf/src/mobile/measure/pointComponent.js","webpack:///./contribs/gmf/examples/mobilemeasure.js"],"names":["webpackJsonpCallback","data","chunkIds","moreModules","executeModules","moduleId","chunkId","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","17","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","getDefault","getModuleExports","object","property","p","jsonpArray","window","oldJsonpFunction","slice","obj","__t","__p","options","olInteractionInteraction","this","handleEvent","olFunctions","changeEventKey_","type_","type","minPoints_","minPoints","sketchFeature_","sketchPoints_","sketchPoint_","overlay_","olLayerVector","source","olSourceVector","useSpatialIndex","wrapX","style","ngeoInteractionCommon","getDefaultDrawStyleFunction","updateWhileAnimating","updateWhileInteracting","olEvents","updateState_","set","olBase","setMap","map","currentMap","getMap","getView","handleViewCenterChange_","getDirty","getDrawing","getValid","getFeature","addToDrawing","active","getActive","drawing","sketchFeatureGeom","sketchPointGeom","getSketchPointGeometry_","coordinate","getCoordinates","coordinates","olFeature","olGeomPoint","event","ngeoCustomEvent","feature","dispatchEvent","getGeometry","googAsserts","assertInstanceof","olGeomSimpleGeometry","setCoordinates","olGeomLineString","dirty","valid","updateSketchFeatures_","clearDrawing","setActive","finishDrawing","startDrawing_","createOrUpdateSketchPoint_","modifyDrawing_","center","getCenter_","pop","abortDrawing_","sketchFeature","getSource","clear","evt","geometry","sketchFeatures","overlaySource","addFeatures","assert","getCenter","assertArray","format","gettextCatalog","opt_options","undefined","olObj","displayHelpTooltip","ngeoInteractionMeasureLength","createDrawInteraction","ngeoInteractionMobileDraw","angular","ngeoMiscFilters","element","attrs","templateUrl","run","$templateCache","put","require","component_","gmfMobileMeasureLengthTemplateUrl","restrict","scope","precision","sketchStyle","controller","bindToController","link","init","directive","Controller_","$scope","$filter","_this","scope_","filter_","gettextCatalog_","$watch","newVal","measure","olStyleStyle","fill","olStyleFill","color","stroke","olStyleStroke","lineDash","width","image","olStyleRegularShape","points","radius","radius2","angle","drawInteraction","ngeoInteractionMeasureLengthMobile","ngeoMiscDecorate","interaction","getDrawInteraction","$apply","addInteraction","addPoint","finish","deactivate","coordFormat","ngeoInteractionMeasure","format_","coordFormat_","handleMeasure","callback","geom","dec","decimals","output","getFormattedPoint","coord","getLastCoordinate","gmfRasterRasterService","ngeoMiscDebounce","gmfMobileMeasurePointTemplateUrl","getCoordinateDecimalsFn","getLayersConfigFn","gmfRaster","ngeoDebounce","gmfRaster_","ngeoDebounce_","$filter_","handleMeasureActiveChange_","coordinateDecimalsFn","coordinateDecimals","layersConfig","mapViewPropertyChangeEventKey_","ngeoInteractionMeasurePointMobile","Array","isArray","translate","str","getString","view","getMeasure_","_this2","params","layers","config","join","getRaster","then","el","getTooltipElement","ctn","document","createElement","className","_iterator","_isArray","_i","iterator","_ref","next","done","childEl","unit","innerHTML","appendChild","previousCtn","getElementsByClassName","remove","LayerConfig","gmfMapComponent","gmfPermalinkPermalink","gmfMobileMeasureLengthComponent","gmfMobileMeasurePointComponent","ngeoMiscBtnComponent","appURL","RASTER","constant","MainController","gmfPermalink","getMapCenter","zoom","getMapZoom","olMap","olLayerTile","olSourceOSM","olView","projection","EPSG21781","resolutions","addControl","olControlScaleLine","measureLengthActive","measurePointLayersConfig","measurePointActive"],"mappings":"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","file":"mobilemeasure.4ff2c7.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t17: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([575,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","module.exports = function (obj) {\nobj || (obj = {});\nvar __t, __p = '';\nwith (obj) {\n__p += '<a class=\"btn btn-default\"\\n   ng-if=\"ctrl.drawing && (!ctrl.valid)\"\\n   ng-click=\"ctrl.addPoint()\">\\n     <span class=\"fa fa-check\"></span>\\n     {{\\'Set as starting point\\' | translate}}\\n</a>\\n<a class=\"btn btn-default\"\\n   ng-if=\"ctrl.dirty\"\\n   ng-click=\"ctrl.addPoint()\">\\n     <span class=\"fa fa-plus\"></span>\\n     {{\\'Add new point\\' | translate}}\\n</a>\\n<a class=\"btn btn-default\"\\n   ng-if=\"ctrl.drawing && ctrl.valid && !ctrl.dirty\"\\n   ng-click=\"ctrl.finish()\">\\n     <span class=\"fa fa-check\"></span>\\n     {{\\'Terminate\\' | translate}}\\n</a>\\n<a class=\"btn btn-default\"\\n   ng-if=\"ctrl.valid\"\\n   ng-click=\"ctrl.clear()\">\\n     <span class=\"fa fa-repeat\"></span>\\n     {{\\'Clear\\' | translate}}\\n</a>\\n<a class=\"btn btn-default\"\\n   ng-if=\"ctrl.active\"\\n   ng-click=\"ctrl.deactivate()\">\\n     <span class=\"fa fa-times\"></span>\\n     {{\\'Close\\' | translate}}\\n</a>\\n';\n\n}\nreturn __p\n}","module.exports = function (obj) {\nobj || (obj = {});\nvar __t, __p = '';\nwith (obj) {\n__p += '<a class=\"btn btn-default\"\\n   ng-if=\"ctrl.active\"\\n   ng-click=\"ctrl.deactivate()\">\\n     <span class=\"fa fa-times\"></span>\\n     {{\\'Close\\' | translate}}\\n</a>\\n';\n\n}\nreturn __p\n}","/**\n * @module ngeo.interaction.MobileDraw\n */\nimport googAsserts from 'goog/asserts.js';\nimport ngeoInteractionCommon from 'ngeo/interaction/common.js';\nimport ngeoCustomEvent from 'ngeo/CustomEvent.js';\nimport * as olBase from 'ol/index.js';\nimport * as olEvents from 'ol/events.js';\nimport olFeature from 'ol/Feature.js';\nimport * as olFunctions from 'ol/functions.js';\nimport olGeomLineString from 'ol/geom/LineString.js';\nimport olGeomPoint from 'ol/geom/Point.js';\nimport olGeomSimpleGeometry from 'ol/geom/SimpleGeometry.js';\nimport olInteractionInteraction from 'ol/interaction/Interaction.js';\nimport olLayerVector from 'ol/layer/Vector.js';\nimport olSourceVector from 'ol/source/Vector.js';\n\n/**\n * @classdesc\n * Interaction for drawing feature geometries from a mobile device using the\n * center of the map view as entry for points added.\n *\n * Supports:\n * - point\n * - line string\n *\n * @constructor\n * @struct\n * @fires ngeox.DrawEvent\n * @extends {ol.interaction.Interaction}\n * @param {ngeox.interaction.MobileDrawOptions} options Options\n */\nconst exports = function(options) {\n\n  olInteractionInteraction.call(this, {\n    handleEvent: olFunctions.TRUE\n  });\n\n  /**\n   * The key for view center change event.\n   * @type {?ol.EventsKey}\n   * @private\n   */\n  this.changeEventKey_ = null;\n\n  /**\n   * Geometry type.\n   * @type {ol.geom.GeometryType}\n   * @private\n   */\n  this.type_ = options.type;\n\n  /**\n   * The number of points that must be drawn before a polygon ring or line\n   * string can be finished.  The default is 3 for polygon rings and 2 for\n   * line strings.\n   * @type {number}\n   * @private\n   */\n  this.minPoints_ = options.minPoints ?\n    options.minPoints :\n    (this.type_ === 'Polygon' ? 3 : 2);\n\n  /**\n   * Sketch feature.\n   * @type {ol.Feature}\n   * @private\n   */\n  this.sketchFeature_ = null;\n\n  /**\n   * Previous sketch points, saved to be able to display them on the layer.\n   * @type {Array.<ol.Feature>}\n   * @private\n   */\n  this.sketchPoints_ = [];\n\n  /**\n   * Current sketch point.\n   * @type {ol.Feature}\n   * @private\n   */\n  this.sketchPoint_ = null;\n\n  /**\n   * Draw overlay where our sketch features are drawn.\n   * @type {ol.layer.Vector}\n   * @private\n   */\n  this.overlay_ = new olLayerVector({\n    source: new olSourceVector({\n      useSpatialIndex: false,\n      wrapX: options.wrapX ? options.wrapX : false\n    }),\n    style: options.style || ngeoInteractionCommon.getDefaultDrawStyleFunction(),\n    updateWhileAnimating: true,\n    updateWhileInteracting: true\n  });\n\n  olEvents.listen(this, 'change:active', this.updateState_, this);\n\n  this.set('dirty', false);\n  this.set('drawing', false);\n  this.set('valid', false);\n\n};\n\nolBase.inherits(exports, olInteractionInteraction);\n\n\n/**\n * @inheritDoc\n */\nexports.prototype.setMap = function(map) {\n\n  const currentMap = this.getMap();\n  if (currentMap) {\n    if (this.changeEventKey_) {\n      olEvents.unlistenByKey(this.changeEventKey_);\n    }\n  }\n\n  olInteractionInteraction.prototype.setMap.call(this, map);\n\n  if (map) {\n    this.changeEventKey_ = olEvents.listen(map.getView(),\n      'change:center',\n      this.handleViewCenterChange_, this);\n  }\n\n  this.updateState_();\n};\n\n\n// === PUBLIC METHODS - PROPERTY GETTERS ===\n\n\n/**\n * Return whether the interaction is currently dirty. It is if the sketch\n * feature has its geometry last coordinate set to the center without the\n * use of the `addToDrawing` method.\n * @return {boolean} `true` if the interaction is dirty, `false` otherwise.\n * @observable\n */\nexports.prototype.getDirty = function() {\n  return /** @type {boolean} */ (\n    this.get('dirty'));\n};\n\n\n/**\n * Return whether the interaction is currently drawing.\n * @return {boolean} `true` if the interaction is drawing, `false` otherwise.\n * @observable\n */\nexports.prototype.getDrawing = function() {\n  return /** @type {boolean} */ (\n    this.get('drawing'));\n};\n\n\n/**\n * Return whether the interaction as a valid sketch feature, i.e. its geometry\n * is valid.\n * @return {boolean} `true` if the interaction has a valid sketch feature,\n *     `false` otherwise.\n * @observable\n */\nexports.prototype.getValid = function() {\n  return /** @type {boolean} */ (\n    this.get('valid'));\n};\n\n\n/**\n * Returns the current sketch feature.\n * @return {?ol.Feature} The sketch feature, or null if none.\n */\nexports.prototype.getFeature = function() {\n  return this.sketchFeature_;\n};\n\n\n// === PUBLIC METHODS ===\n\n\n/**\n * Add current sketch point to sketch feature if the latter exists, else create\n * it.\n */\nexports.prototype.addToDrawing = function() {\n\n  // no need to do anything if interaction is not active, nor drawing\n  const active = this.getActive();\n  const drawing = this.getDrawing();\n\n  if (!active || !drawing) {\n    return;\n  }\n\n  let sketchFeatureGeom;\n  const sketchPointGeom = this.getSketchPointGeometry_();\n  const coordinate = sketchPointGeom.getCoordinates();\n  let coordinates;\n\n  // == point ==\n  if (this.type_ === 'Point') {\n    if (!this.sketchFeature_) {\n      this.sketchFeature_ = new olFeature(new olGeomPoint(coordinate));\n      /** @type {ngeox.DrawEvent} */\n      const event = new ngeoCustomEvent('drawstart', {feature: this.sketchFeature_});\n      this.dispatchEvent(event);\n    }\n    sketchFeatureGeom = this.sketchFeature_.getGeometry();\n    googAsserts.assertInstanceof(sketchFeatureGeom, olGeomSimpleGeometry);\n    sketchFeatureGeom.setCoordinates(coordinate);\n    return;\n  }\n\n  // == line string ==\n  if (this.type_ === 'LineString') {\n    this.sketchPoints_.push(this.sketchPoint_);\n    if (!this.sketchFeature_) {\n      coordinates = [coordinate.slice(), coordinate.slice()];\n      this.sketchFeature_ = new olFeature(new olGeomLineString(coordinates));\n      /** @type {ngeox.DrawEvent} */\n      const event = new ngeoCustomEvent('drawstart', {feature: this.sketchFeature_});\n      this.dispatchEvent(event);\n    } else {\n      sketchFeatureGeom = this.sketchFeature_.getGeometry();\n      googAsserts.assertInstanceof(sketchFeatureGeom, olGeomSimpleGeometry);\n      coordinates = sketchFeatureGeom.getCoordinates();\n      coordinates.push(coordinate.slice());\n      sketchFeatureGeom.setCoordinates(coordinates);\n    }\n  }\n\n  const dirty = this.getDirty();\n  if (dirty) {\n    this.set('dirty', false);\n  }\n\n  // minPoints validation\n  const valid = this.getValid();\n  if (this.type_ === 'LineString') {\n    if (coordinates.length >= this.minPoints_) {\n      if (!valid) {\n        this.set('valid', true);\n      }\n    } else {\n      if (valid) {\n        this.set('valid', false);\n      }\n    }\n  }\n\n  // reset sketch point\n  this.sketchPoint_ = null;\n\n  // update sketch features\n  this.updateSketchFeatures_();\n};\n\n\n/**\n * Clear the drawing\n */\nexports.prototype.clearDrawing = function() {\n  this.setActive(false);\n  this.setActive(true);\n};\n\n\n/**\n * Finish drawing. If there's a sketch point, it's added first.\n */\nexports.prototype.finishDrawing = function() {\n\n  // no need to do anything if interaction is not active, nor drawing\n  const active = this.getActive();\n  const drawing = this.getDrawing();\n\n  if (!active || !drawing) {\n    return;\n  }\n\n  if (this.sketchPoint_) {\n    this.addToDrawing();\n  }\n\n  this.set('drawing', false);\n\n  /** @type {ngeox.DrawEvent} */\n  const event = new ngeoCustomEvent('drawend', {feature: this.sketchFeature_});\n  this.dispatchEvent(event);\n};\n\n\n// === PRIVATE METHODS ===\n\n\n/**\n * Start drawing by adding the sketch point first.\n * @private\n */\nexports.prototype.startDrawing_ = function() {\n  this.set('drawing', true);\n  this.createOrUpdateSketchPoint_();\n  this.updateSketchFeatures_();\n\n  if (this.type_ === 'Point') {\n    this.addToDrawing();\n  }\n};\n\n\n/**\n * Modify the geometry of the sketch feature to have its last coordinate\n * set to the center of the map.\n * @private\n */\nexports.prototype.modifyDrawing_ = function() {\n  if (!this.sketchFeature_) {\n    return;\n  }\n\n  const center = this.getCenter_();\n\n  if (this.type_ === 'LineString') {\n    const sketchFeatureGeom = this.sketchFeature_.getGeometry();\n    googAsserts.assertInstanceof(sketchFeatureGeom, olGeomSimpleGeometry);\n    const coordinates = sketchFeatureGeom.getCoordinates();\n    coordinates.pop();\n    coordinates.push(center);\n    sketchFeatureGeom.setCoordinates(coordinates);\n  }\n\n  const dirty = this.getDirty();\n  if (!dirty) {\n    this.set('dirty', true);\n  }\n\n};\n\n\n/**\n * Stop drawing without adding the sketch feature to the target layer.\n * @return {?ol.Feature} The sketch feature (or null if none).\n * @private\n */\nexports.prototype.abortDrawing_ = function() {\n  const sketchFeature = this.sketchFeature_;\n  if (sketchFeature || this.sketchPoints_.length > 0) {\n    this.sketchFeature_ = null;\n    this.sketchPoint_ = null;\n    this.overlay_.getSource().clear(true);\n  }\n  this.sketchPoints_ = [];\n  this.set('dirty', false);\n  this.set('drawing', false);\n  this.set('valid', false);\n  return sketchFeature;\n};\n\n\n/**\n * @private\n */\nexports.prototype.updateState_ = function() {\n  const map = this.getMap();\n  const active = this.getActive();\n  if (!map || !active) {\n    this.abortDrawing_();\n  } else {\n    this.startDrawing_();\n  }\n  this.overlay_.setMap(active ? map : null);\n};\n\n\n/**\n * @param {ol.Object.Event} evt Event.\n * @private\n */\nexports.prototype.handleViewCenterChange_ = function(evt) {\n  // no need to do anything if interaction is not active, nor drawing\n  const active = this.getActive();\n  const drawing = this.getDrawing();\n\n  if (!active || !drawing) {\n    return;\n  }\n\n  this.createOrUpdateSketchPoint_();\n\n  if (this.type_ === 'Point') {\n    this.addToDrawing();\n  } else {\n    this.modifyDrawing_();\n    this.updateSketchFeatures_();\n  }\n};\n\n\n/**\n * @private\n */\nexports.prototype.createOrUpdateSketchPoint_ = function() {\n  const center = this.getCenter_();\n\n  if (this.sketchPoint_) {\n    const geometry = this.getSketchPointGeometry_();\n    geometry.setCoordinates(center);\n  } else {\n    this.sketchPoint_ = new olFeature(new olGeomPoint(center));\n  }\n\n};\n\n\n/**\n * Redraw the sketch features.\n * @private\n */\nexports.prototype.updateSketchFeatures_ = function() {\n  const sketchFeatures = [];\n  if (this.sketchFeature_) {\n    sketchFeatures.push(this.sketchFeature_);\n  }\n  if (this.sketchPoint_) {\n    sketchFeatures.push(this.sketchPoint_);\n  }\n  const overlaySource = this.overlay_.getSource();\n  overlaySource.clear(true);\n  overlaySource.addFeatures(sketchFeatures);\n  overlaySource.addFeatures(this.sketchPoints_);\n};\n\n\n/**\n * Returns the geometry of the sketch point feature.\n * @return {ol.geom.Point} Point.\n * @private\n */\nexports.prototype.getSketchPointGeometry_ = function() {\n  googAsserts.assert(this.sketchPoint_, 'sketch point should be thruty');\n  const geometry = this.sketchPoint_.getGeometry();\n  googAsserts.assertInstanceof(geometry, olGeomPoint);\n  return geometry;\n};\n\n\n/**\n * Returns the center of the map view\n * @return {ol.Coordinate} Coordinate.\n * @private\n */\nexports.prototype.getCenter_ = function() {\n  const center = this.getMap().getView().getCenter();\n  googAsserts.assertArray(center);\n  return center;\n};\n\n\nexport default exports;\n","/**\n * @module ngeo.interaction.MeasureLengthMobile\n */\nimport ngeoInteractionMeasureLength from 'ngeo/interaction/MeasureLength.js';\nimport ngeoInteractionMobileDraw from 'ngeo/interaction/MobileDraw.js';\nimport * as olBase from 'ol/index.js';\nimport * as olObj from 'ol/obj.js';\n\n/**\n * @classdesc\n * Interaction dedicated to measure length on mobile devices.\n *\n * @constructor\n * @struct\n * @extends {ngeo.interaction.MeasureLength}\n * @param {!ngeox.unitPrefix} format The format function\n * @param {!angularGettext.Catalog} gettextCatalog Gettext catalog.\n * @param {ngeox.interaction.MeasureOptions=} opt_options Options\n */\nconst exports = function(format, gettextCatalog, opt_options) {\n\n  const options = opt_options !== undefined ? opt_options : {};\n\n  olObj.assign(options, {displayHelpTooltip: false});\n\n  ngeoInteractionMeasureLength.call(this, format, gettextCatalog, options);\n\n};\n\nolBase.inherits(\n  exports, ngeoInteractionMeasureLength);\n\n\n/**\n * @inheritDoc\n */\nexports.prototype.createDrawInteraction = function(style, source) {\n  return new ngeoInteractionMobileDraw({\n    type: /** @type {ol.geom.GeometryType} */ ('LineString'),\n    style: style,\n    source: source\n  });\n};\n\n\nexport default exports;\n","/**\n * @module gmf.mobile.measure.lengthComponent\n */\nimport ngeoMiscFilters from 'ngeo/misc/filters.js';\nimport ngeoInteractionMeasureLengthMobile from 'ngeo/interaction/MeasureLengthMobile.js';\nimport ngeoMiscDecorate from 'ngeo/misc/decorate.js';\nimport * as olEvents from 'ol/events.js';\nimport olStyleFill from 'ol/style/Fill.js';\nimport olStyleRegularShape from 'ol/style/RegularShape.js';\nimport olStyleStroke from 'ol/style/Stroke.js';\nimport olStyleStyle from 'ol/style/Style.js';\n\nconst exports = angular.module('gmfMobileMeasureLength', [\n  ngeoMiscFilters.name,\n]);\n\n\nexports.value('gmfMobileMeasureLengthTemplateUrl',\n  /**\n   * @param {angular.JQLite} element Element.\n   * @param {angular.Attributes} attrs Attributes.\n   * @return {string} The template url.\n   */\n  (element, attrs) => {\n    const templateUrl = attrs['gmfMobileMeasureLengthTemplateurl'];\n    return templateUrl !== undefined ? templateUrl :\n      'gmf/measure/lengthComponent';\n  });\n\nexports.run(/* @ngInject */ ($templateCache) => {\n  $templateCache.put('gmf/measure/lengthComponent', require('./lengthComponent.html'));\n});\n\n\n/**\n * Provide a directive to do a length measure on the mobile devices.\n *\n * Example:\n *\n *      <div gmf-mobile-measurelength\n *        gmf-mobile-measurelength-active=\"ctrl.measureLengthActive\"\n *        gmf-mobile-measurelength-map=\"::ctrl.map\">\n *      </div>\n *\n * @htmlAttribute {boolean} gmf-mobile-measurelength-active Used to active\n * or deactivate the component.\n * @htmlAttribute {number=} gmf-mobile-measurelength-precision the number of significant digits to display.\n * @htmlAttribute {ol.Map} gmf-mobile-measurelength-map The map.\n * @htmlAttribute {ol.style.Style|Array.<ol.style.Style>|ol.StyleFunction=}\n *     gmf-mobile-measurelength-sketchstyle A style for the measure length.\n * @param {string|function(!angular.JQLite=, !angular.Attributes=)}\n *     gmfMobileMeasureLengthTemplateUrl Template URL for the directive.\n * @return {angular.Directive} The Directive Definition Object.\n * @ngInject\n * @ngdoc directive\n * @ngname gmfMobileMeasureLength\n */\nexports.component_ =\n    function(gmfMobileMeasureLengthTemplateUrl) {\n      return {\n        restrict: 'A',\n        scope: {\n          'active': '=gmfMobileMeasurelengthActive',\n          'precision': '<?gmfMobileMeasurelengthPrecision',\n          'map': '=gmfMobileMeasurelengthMap',\n          'sketchStyle': '=?gmfMobileMeasurelengthSketchstyle'\n        },\n        controller: 'GmfMobileMeasureLengthController as ctrl',\n        bindToController: true,\n        templateUrl: gmfMobileMeasureLengthTemplateUrl,\n        /**\n         * @param {angular.Scope} scope Scope.\n         * @param {angular.JQLite} element Element.\n         * @param {angular.Attributes} attrs Attributes.\n         * @param {gmf.mobile.measure.lengthComponent.Controller_} controller Controller.\n         */\n        link: (scope, element, attrs, controller) => {\n          controller.init();\n        }\n      };\n    };\n\n\nexports.directive('gmfMobileMeasurelength',\n  exports.component_);\n\n\n/**\n * @param {!angular.Scope} $scope Angular scope.\n * @param {!angular.$filter} $filter Angular filter\n * @param {!angularGettext.Catalog} gettextCatalog Gettext catalog.\n * @constructor\n * @private\n * @struct\n * @ngInject\n * @ngdoc controller\n * @ngname GmfMobileMeasureLengthController\n */\nexports.Controller_ = function($scope, $filter, gettextCatalog) {\n\n  /**\n   * @type {angular.Scope}\n   * @private\n   */\n  this.scope_ = $scope;\n\n  /**\n   * @type {angular.$filter}\n   * @private\n   */\n  this.filter_ = $filter;\n\n  /**\n   * @type {!angularGettext.Catalog}\n   * @private\n   */\n  this.gettextCatalog_ = gettextCatalog;\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.active;\n\n  this.scope_.$watch(() => this.active, (newVal) => {\n    this.measure.setActive(newVal);\n  });\n\n  /**\n   * @type {number|undefined}\n   * @export\n   */\n  this.precision;\n\n  /**\n   * @type {ol.style.Style|Array.<ol.style.Style>|ol.StyleFunction}\n   * @export\n   */\n  this.sketchStyle = new olStyleStyle({\n    fill: new olStyleFill({\n      color: 'rgba(255, 255, 255, 0.2)'\n    }),\n    stroke: new olStyleStroke({\n      color: 'rgba(0, 0, 0, 0.5)',\n      lineDash: [10, 10],\n      width: 2\n    }),\n    image: new olStyleRegularShape({\n      stroke: new olStyleStroke({\n        color: 'rgba(0, 0, 0, 0.7)',\n        width: 2\n      }),\n      points: 4,\n      radius: 8,\n      radius2: 0,\n      angle: 0\n    })\n  });\n\n  /**\n   * @type {ngeo.interaction.MeasureLengthMobile}\n   * @export\n   */\n  this.measure;\n\n  /**\n   * @type {ngeo.interaction.MobileDraw}\n   * @export\n   */\n  this.drawInteraction;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.dirty = false;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.drawing = false;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.valid = false;\n};\n\n/**\n * Initialise the controller.\n */\nexports.Controller_.prototype.init = function() {\n\n  this.measure = new ngeoInteractionMeasureLengthMobile(this.filter_('ngeoUnitPrefix'), this.gettextCatalog_, {\n    precision: this.precision,\n    sketchStyle: this.sketchStyle\n  });\n\n  this.measure.setActive(this.active);\n  ngeoMiscDecorate.interaction(this.measure);\n\n\n  this.drawInteraction = /** @type {ngeo.interaction.MobileDraw} */ (\n    this.measure.getDrawInteraction());\n\n  const drawInteraction = this.drawInteraction;\n  ngeoMiscDecorate.interaction(drawInteraction);\n\n  Object.defineProperty(this, 'hasPoints', {\n    get() {\n      return this.drawInteraction.getFeature() !== null;\n    }\n  });\n\n  olEvents.listen(\n    drawInteraction,\n    'change:dirty',\n    function() {\n      this.dirty = drawInteraction.getDirty();\n\n      // this is where the angular scope is forced to be applied. We\n      // only need to do this when dirty, as going to \"no being dirty\"\n      // is made by a click on a button where Angular is within scope\n      if (this.dirty) {\n        this.scope_.$apply();\n      }\n    },\n    this\n  );\n\n  olEvents.listen(\n    drawInteraction,\n    'change:drawing',\n    function() {\n      this.drawing = drawInteraction.getDrawing();\n    },\n    this\n  );\n\n  olEvents.listen(\n    drawInteraction,\n    'change:valid',\n    function() {\n      this.valid = drawInteraction.getValid();\n    },\n    this\n  );\n\n  this.map.addInteraction(this.measure);\n};\n\n/**\n * Add current sketch point to line measure\n * @export\n */\nexports.Controller_.prototype.addPoint = function() {\n  this.drawInteraction.addToDrawing();\n};\n\n\n/**\n * Clear the sketch feature\n * @export\n */\nexports.Controller_.prototype.clear = function() {\n  this.drawInteraction.clearDrawing();\n};\n\n\n/**\n * Finish line measure\n * @export\n */\nexports.Controller_.prototype.finish = function() {\n  this.drawInteraction.finishDrawing();\n};\n\n\n/**\n * Deactivate the directive.\n * @export\n */\nexports.Controller_.prototype.deactivate = function() {\n  this.active = false;\n};\n\n\nexports.controller('GmfMobileMeasureLengthController',\n  exports.Controller_);\n\n\nexport default exports;\n","/**\n * @module ngeo.interaction.MeasurePointMobile\n */\nimport googAsserts from 'goog/asserts.js';\nimport ngeoInteractionMeasure from 'ngeo/interaction/Measure.js';\nimport ngeoInteractionMobileDraw from 'ngeo/interaction/MobileDraw.js';\nimport * as olBase from 'ol/index.js';\nimport * as olObj from 'ol/obj.js';\nimport olGeomPoint from 'ol/geom/Point.js';\n\n/**\n * @classdesc\n * Interaction dedicated to measure by coordinate (point) on mobile devices.\n *\n * @constructor\n * @struct\n * @extends {ngeo.interaction.Measure}\n * @param {ngeox.numberCoordinates} format the number formatter\n * @param {string} coordFormat the coordinates formatter\n * @param {ngeox.interaction.MeasureOptions=} options Options\n */\nconst exports = function(format, coordFormat, options = /** @type {ngeox.interaction.MeasureOptions} */ ({})) {\n\n  olObj.assign(options, {displayHelpTooltip: false});\n\n  ngeoInteractionMeasure.call(this, /** @type {ngeo.interaction.MeasureBaseOptions} */(options));\n\n  /**\n   * @type {ngeox.numberCoordinates}\n   * @private\n   */\n  this.format_ = format;\n\n  /**\n   * @type {string}\n   * @private\n   */\n  this.coordFormat_ = coordFormat;\n};\n\nolBase.inherits(exports, ngeoInteractionMeasure);\n\n\n/**\n * @inheritDoc\n */\nexports.prototype.createDrawInteraction = function(style, source) {\n  return new ngeoInteractionMobileDraw({\n    type: /** @type {ol.geom.GeometryType} */ ('Point'),\n    style: style,\n    source: source\n  });\n};\n\n\n/**\n * @inheritDoc\n */\nexports.prototype.handleMeasure = function(callback) {\n  const geom = googAsserts.assertInstanceof(this.sketchFeature.getGeometry(), olGeomPoint);\n  const dec = this.decimals;\n  const output = ngeoInteractionMeasure.getFormattedPoint(geom, dec, this.format_, this.coordFormat_);\n  const coord = geom.getLastCoordinate();\n  callback(output, coord);\n};\n\n\nexport default exports;\n","/**\n * @module gmf.mobile.measure.pointComponent\n */\nimport gmfRasterRasterService from 'gmf/raster/RasterService.js';\nimport googAsserts from 'goog/asserts.js';\nimport ngeoInteractionMeasurePointMobile from 'ngeo/interaction/MeasurePointMobile.js';\nimport ngeoMiscDebounce from 'ngeo/misc/debounce.js';\nimport ngeoMiscDecorate from 'ngeo/misc/decorate.js';\nimport * as olEvents from 'ol/events.js';\nimport olStyleFill from 'ol/style/Fill.js';\nimport olStyleRegularShape from 'ol/style/RegularShape.js';\nimport olStyleStroke from 'ol/style/Stroke.js';\nimport olStyleStyle from 'ol/style/Style.js';\n\nconst exports = angular.module('gmfMobileMeasurePoint', [\n  gmfRasterRasterService.module.name,\n  ngeoMiscDebounce.name,\n]);\n\n\nexports.value('gmfMobileMeasurePointTemplateUrl',\n  /**\n   * @param {angular.JQLite} element Element.\n   * @param {angular.Attributes} attrs Attributes.\n   * @return {string} The template url.\n   */\n  (element, attrs) => {\n    const templateUrl = attrs['gmfMobileMeasurePointTemplateurl'];\n    return templateUrl !== undefined ? templateUrl :\n      'gmf/measure/pointComponent';\n  });\n\nexports.run(/* @ngInject */ ($templateCache) => {\n  $templateCache.put('gmf/measure/pointComponent', require('./pointComponent.html'));\n});\n\n\n/**\n * Provide a directive to do a point (coordinate and elevation) measure on the\n * mobile devices.\n *\n * Example:\n *\n *      <div gmf-mobile-measurepoint\n *        gmf-mobile-measurepoint-active=\"ctrl.measurePointActive\"\n *        gmf-mobile-measurepoint-layersconfig=\"::ctrl.measurePointLayers\"\n *        gmf-mobile-measurepoint-map=\"::ctrl.map\">\n *      </div>\n *\n * Where ctrl.measurePointLayers is an object like this:\n *\n *      this.measurePointLayers = [\n *        {name: 'srtm', unit: 'm', decimals: 2},\n *        {name: 'wind', {unit: 'km/h'},\n *        {name: 'humidity'}\n *      ];\n *\n * @htmlAttribute {boolean} gmf-mobile-measurepoint-active Used to active\n * or deactivate the component.\n * @htmlAttribute {number=} gmf-mobile-measurepoint-coordinatedecimals number\n *     of decimal to display for the coordinate.\n * @htmlAttribute {Array.<gmf.mobile.measure.pointComponent.LayerConfig>}\n *     gmf-mobile-measurepoint-layersconfig Raster elevation layers to get\n *     information under the point and its configuaration.\n * @htmlAttribute {ol.Map} gmf-mobile-measurepoint-map The map.\n * @htmlAttribute {ol.style.Style|Array.<ol.style.Style>|ol.StyleFunction=}\n *     gmf-mobile-measurepoint-sketchstyle A style for the measure point.\n * @param {string|function(!angular.JQLite=, !angular.Attributes=)}\n *     gmfMobileMeasurePointTemplateUrl Template URL for the directive.\n * @return {angular.Directive} The Directive Definition Object.\n * @ngInject\n * @ngdoc directive\n * @ngname gmfMobileMeasurePoint\n */\nexports.component_ =\n    function(gmfMobileMeasurePointTemplateUrl) {\n      return {\n        restrict: 'A',\n        scope: {\n          'active': '=gmfMobileMeasurepointActive',\n          'getCoordinateDecimalsFn': '&?gmfMobileMeasurepointCoordinatedecimals',\n          'getLayersConfigFn': '&gmfMobileMeasurepointLayersconfig',\n          'map': '=gmfMobileMeasurepointMap',\n          'sketchStyle': '=?gmfMobileMeasurepointSketchstyle',\n          'format': '<gmfMobileMeasurepointFormat'\n        },\n        controller: 'GmfMobileMeasurePointController as ctrl',\n        bindToController: true,\n        templateUrl: gmfMobileMeasurePointTemplateUrl,\n        /**\n         * @param {!angular.Scope} scope Scope.\n         * @param {!angular.JQLite} element Element.\n         * @param {!angular.Attributes} attrs Attributes.\n         * @param {!gmf.mobile.measure.pointComponent.Controller_} controller Controller.\n         */\n        link: (scope, element, attrs, controller) => {\n          controller.init();\n        }\n      };\n    };\n\n\nexports.directive('gmfMobileMeasurepoint',\n  exports.component_);\n\n\n/**\n * @param {angularGettext.Catalog} gettextCatalog Gettext catalog.\n * @param {!angular.Scope} $scope Angular scope.\n * @param {angular.$filter} $filter Angular filter service.\n * @param {gmf.raster.RasterService} gmfRaster gmf Raster service.\n * @param {ngeox.miscDebounce} ngeoDebounce ngeo Debounce factory.\n * @constructor\n * @private\n * @ngInject\n * @ngdoc controller\n * @ngname GmfMobileMeasurePointController\n */\nexports.Controller_ = function(gettextCatalog, $scope, $filter,\n  gmfRaster, ngeoDebounce) {\n\n  /**\n   * @type {gmf.raster.RasterService}\n   * @private\n   */\n  this.gmfRaster_ = gmfRaster;\n\n  /**\n   * @type {ngeox.miscDebounce}\n   * @private\n   */\n  this.ngeoDebounce_ = ngeoDebounce;\n\n  /**\n   * @type {angularGettext.Catalog}\n   * @private\n   */\n  this.gettextCatalog_ = gettextCatalog;\n\n  /**\n   * @type {angular.$filter}\n   * @private\n   */\n  this.$filter_ = $filter;\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map;\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.active;\n\n  $scope.$watch(() => this.active, (newVal) => {\n    this.measure.setActive(newVal);\n    this.handleMeasureActiveChange_();\n  });\n\n  const coordinateDecimalsFn = this['getCoordinateDecimalsFn'];\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.coordinateDecimals = coordinateDecimalsFn ? coordinateDecimalsFn() : 0;\n\n  /**\n   * @type {!Array.<gmf.mobile.measure.pointComponent.LayerConfig>}\n   * @private\n   */\n  this.layersConfig;\n\n  /**\n   * @type {ol.style.Style|Array.<ol.style.Style>|ol.StyleFunction}\n   * @export\n   */\n  this.sketchStyle;\n\n  if (this.sketchStyle === undefined) {\n    this.sketchStyle = new olStyleStyle({\n      fill: new olStyleFill({\n        color: 'rgba(255, 255, 255, 0.2)'\n      }),\n      stroke: new olStyleStroke({\n        color: 'rgba(0, 0, 0, 0.5)',\n        lineDash: [10, 10],\n        width: 2\n      }),\n      image: new olStyleRegularShape({\n        stroke: new olStyleStroke({\n          color: 'rgba(0, 0, 0, 0.7)',\n          width: 2\n        }),\n        points: 4,\n        radius: 8,\n        radius2: 0,\n        angle: 0\n      })\n    });\n  }\n\n  /**\n   * @type {string}\n   */\n  this.format;\n\n  /**\n   * @type {ngeo.interaction.MeasurePointMobile}\n   * @export\n   */\n  this.measure;\n\n  /**\n   * @type {ngeo.interaction.MobileDraw}\n   * @export\n   */\n  this.drawInteraction;\n\n  /**\n   * The key for map view 'propertychange' event.\n   * @type {?ol.EventsKey}\n   * @private\n   */\n  this.mapViewPropertyChangeEventKey_ = null;\n};\n\n\n/**\n * Initialise the controller.\n */\nexports.Controller_.prototype.init = function() {\n  this.measure = new ngeoInteractionMeasurePointMobile(\n    /** @type {ngeox.numberCoordinates} */ (this.$filter_('ngeoNumberCoordinates')),\n    this.format || '{x}, {y}',\n    {\n      decimals: this.coordinateDecimals,\n      sketchStyle: this.sketchStyle\n    }\n  );\n  this.measure.setActive(this.active);\n  ngeoMiscDecorate.interaction(this.measure);\n  this.drawInteraction = /** @type {ngeo.interaction.MobileDraw} */ (this.measure.getDrawInteraction());\n  ngeoMiscDecorate.interaction(this.drawInteraction);\n\n  const layersConfig = this['getLayersConfigFn']();\n  googAsserts.assert(Array.isArray(layersConfig));\n  this.layersConfig = layersConfig;\n\n  this.map.addInteraction(this.measure);\n};\n\n\n/**\n * Deactivate the directive.\n * @export\n */\nexports.Controller_.prototype.deactivate = function() {\n  this.active = false;\n};\n\n\n/**\n * @param {string} str String to translate.\n * @return {string} The translated text.\n * @export\n */\nexports.Controller_.prototype.translate = function(str) {\n  return this.gettextCatalog_.getString(str);\n};\n\n\n/**\n * Called when the measure becomes active or inactive. Act accordingly:\n * - on activate, listen to the map property changes to call for the elevation\n *   service.\n * - on deactivate, unlisten\n * @private\n */\nexports.Controller_.prototype.handleMeasureActiveChange_ = function() {\n  if (this.measure.getActive()) {\n    const view = this.map.getView();\n    this.mapViewPropertyChangeEventKey_ = olEvents.listen(\n      view,\n      'propertychange',\n      this.ngeoDebounce_(\n        this.getMeasure_.bind(this), 300, /* invokeApply */ true),\n      this);\n    this.getMeasure_();\n  } else if (this.mapViewPropertyChangeEventKey_) {\n    olEvents.unlistenByKey(this.mapViewPropertyChangeEventKey_);\n    this.mapViewPropertyChangeEventKey_ = null;\n  }\n};\n\n\n/**\n * Call the elevation service to get information about the measure at\n * the current map center location.\n * @private\n */\nexports.Controller_.prototype.getMeasure_ = function() {\n  const center = this.map.getView().getCenter();\n  googAsserts.assertArray(center);\n  const params = {\n    'layers': this.layersConfig.map(config => config.name).join(',')\n  };\n  this.gmfRaster_.getRaster(center, params).then((object) => {\n    const el = this.measure.getTooltipElement();\n    const ctn = document.createElement('div');\n    const className = 'gmf-mobile-measure-point';\n    ctn.className = className;\n\n    for (const config of this.layersConfig) {\n      const key = config.name;\n      if (key in object) {\n        let value = object[key];\n        const childEl = document.createElement('div');\n        childEl.className = `gmf-mobile-measure-point-${key}`;\n        const unit = config.unit || '';\n        const decimals = config.decimals && config.decimals > 0 || 0;\n        value = this.$filter_('number')(value, decimals);\n        childEl.innerHTML = [this.translate(key), ': ', value, ' ', unit].join('');\n        ctn.appendChild(childEl);\n      }\n    }\n\n    const previousCtn = el.getElementsByClassName(className);\n    if (previousCtn[0]) {\n      previousCtn[0].remove();\n    }\n    el.appendChild(ctn);\n\n  });\n};\n\n\nexports.controller('GmfMobileMeasurePointController',\n  exports.Controller_);\n\n/**\n * @typedef {{\n *     name: string,\n *     decimals: (number|undefined),\n *     unit: (string|undefined)\n * }}\n */\nexports.LayerConfig;\n\n\nexport default exports;\n","/**\n * @module gmfapp.mobilemeasure\n */\nconst exports = {};\n\nimport appURL from './url.js';\nimport './mobilemeasure.css';\n/** @suppress {extraRequire} */\nimport gmfMapComponent from 'gmf/map/component.js';\n\n/** @suppress {extraRequire} */\nimport gmfPermalinkPermalink from 'gmf/permalink/Permalink.js';\n\nimport gmfMobileMeasureLengthComponent from 'gmf/mobile/measure/lengthComponent.js';\nimport gmfMobileMeasurePointComponent from 'gmf/mobile/measure/pointComponent.js';\nimport ngeoMiscBtnComponent from 'ngeo/misc/btnComponent.js';\nimport EPSG21781 from 'ngeo/proj/EPSG21781.js';\nimport olMap from 'ol/Map.js';\nimport olView from 'ol/View.js';\nimport olControlScaleLine from 'ol/control/ScaleLine.js';\nimport olLayerTile from 'ol/layer/Tile.js';\nimport olSourceOSM from 'ol/source/OSM.js';\n\n\n/** @type {!angular.Module} **/\nexports.module = angular.module('gmfapp', [\n  'gettext',\n  gmfMapComponent.name,\n  gmfPermalinkPermalink.module.name,\n  gmfMobileMeasureLengthComponent.name,\n  gmfMobileMeasurePointComponent.name,\n  ngeoMiscBtnComponent.name,\n]);\n\n\nexports.module.value('gmfRasterUrl', appURL.RASTER);\n\nexports.module.constant('defaultTheme', 'Demo');\nexports.module.constant('angularLocaleScript', '../build/angular-locale_{{locale}}.js');\n\n\n/**\n * @param {gmf.permalink.Permalink} gmfPermalink The gmf permalink service.\n * @constructor\n * @ngInject\n */\nexports.MainController = function(gmfPermalink) {\n\n  const center = gmfPermalink.getMapCenter() || [537635, 152640];\n  const zoom = gmfPermalink.getMapZoom() || 3;\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map = new olMap({\n    layers: [\n      new olLayerTile({\n        source: new olSourceOSM()\n      })\n    ],\n    view: new olView({\n      projection: EPSG21781,\n      resolutions: [200, 100, 50, 20, 10, 5, 2.5, 2, 1, 0.5],\n      center: center,\n      zoom: zoom\n    })\n  });\n\n  this.map.addControl(new olControlScaleLine());\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.measureLengthActive = false;\n\n  /**\n   * @type {Object.<string, gmf.mobile.measure.pointComponent.LayerConfig>}\n   * @export\n   */\n  this.measurePointLayersConfig = [\n    {name: 'aster', unit: 'm', decimals: 2},\n    {name: 'srtm', unit: 'm'}\n  ];\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.measurePointActive = false;\n\n};\n\n\nexports.module.controller('MainController', exports.MainController);\n\n\nexport default exports;\n"],"sourceRoot":""}