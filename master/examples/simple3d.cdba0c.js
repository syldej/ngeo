(function(s){function t(t){var e=t[0];var i=t[1];var n=t[2];var a,o,r=0,l=[];for(;r<e.length;r++){o=e[r];if(m[o]){l.push(m[o][0])}m[o]=0}for(a in i){if(Object.prototype.hasOwnProperty.call(i,a)){s[a]=i[a]}}if(d)d(t);while(l.length){l.shift()()}c.push.apply(c,n||[]);return u()}function u(){var t;for(var e=0;e<c.length;e++){var i=c[e];var n=true;for(var a=1;a<i.length;a++){var o=i[a];if(m[o]!==0)n=false}if(n){c.splice(e--,1);t=r(r.s=i[0])}}return t}var i={};var m={41:0};var c=[];function r(t){if(i[t]){return i[t].exports}var e=i[t]={i:t,l:false,exports:{}};s[t].call(e.exports,e,e.exports,r);e.l=true;return e.exports}r.m=s;r.c=i;r.d=function(t,e,i){if(!r.o(t,e)){Object.defineProperty(t,e,{enumerable:true,get:i})}};r.r=function(t){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(t,"__esModule",{value:true})};r.t=function(e,t){if(t&1)e=r(e);if(t&8)return e;if(t&4&&typeof e==="object"&&e&&e.__esModule)return e;var i=Object.create(null);r.r(i);Object.defineProperty(i,"default",{enumerable:true,value:e});if(t&2&&typeof e!="string")for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i};r.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};r.d(t,"a",t);return t};r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};r.p="";var e=window["webpackJsonp"]=window["webpackJsonp"]||[];var n=e.push.bind(e);e.push=t;e=e.slice();for(var a=0;a<e.length;a++)t(e[a]);var d=n;c.push([531,0]);return u()})({531:function(t,e,i){i(51);i(52);t.exports=i(538)},532:function(t,e){},533:function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj){__p+='<div class="ngeo-tools">\n  <div class="ngeo-angle"><div class="ngeo-angle3d"></div></div>\n  <button class="ngeo-left ngeo-tilt-left" ng-click="$ctrl.tilt(5)"></button>\n  <button class="ngeo-right ngeo-tilt-right" ng-click="$ctrl.tilt(-5)"></button>\n</div>\n<div class="ngeo-zoom">\n  <button class="ol-zoom-in" ng-click="$ctrl.zoom(1)"></button>\n  <button class="ol-zoom-out" ng-click="$ctrl.zoom(-1)"></button>\n</div>\n<div class="ngeo-tools">\n  <div class="ngeo-rotation"><div class="ngeo-rotation3d"></div></div>\n  <button class="ngeo-left" ng-click="$ctrl.rotate(-15)"></button>\n  <button class="ngeo-right" ng-click="$ctrl.rotate(15)"></button>\n</div>\n'}return __p}},538:function(t,e,i){"use strict";i.r(e);var n=i(532);var a=i(19);var o=i(25);var r=i(18);var l=i(30);var s=i(1);var u=i(141);var m=i(225);var c={};c.Permalink3dParam={ENABLED:"3d_enabled",LON:"3d_lon",LAT:"3d_lat",ELEVATION:"3d_elevation",HEADING:"3d_heading",PITCH:"3d_pitch",PREFIX:"3d_"};var d=c;var g=i(288);var h=function(){t.$inject=["ngeoDebounce","ngeoLocation","ngeoStateManager"];function t(t,e,i){this.manager_;this.ngeoDebounce_=t;this.ngeoLocation_=e;this.ngeoStateManager_=i}var e=t.prototype;e.initialize=function t(e){var i=this;this.manager_=e;this.manager_.on("load",function(){i.cameraToState_()});if(this.ngeoStateManager_.getInitialBooleanValue("3d_enabled")){this.initialStateToCamera_()}};e.getManager=function t(){return this.manager_};e.initialStateToCamera_=function t(){var e=this.ngeoStateManager_;var i=e.getInitialNumberValue(d.Permalink3dParam.LON);var n=e.getInitialNumberValue(d.Permalink3dParam.LAT);var a=e.getInitialNumberValue(d.Permalink3dParam.ELEVATION);var o=e.getInitialNumberValue(d.Permalink3dParam.HEADING)||0;var r=e.getInitialNumberValue(d.Permalink3dParam.PITCH)||0;s["a"].assert(i!==undefined);s["a"].assert(n!==undefined);s["a"].assert(a!==undefined);return this.manager_.set3dWithView(i,n,a,o,r)};e.cameraToState_=function t(){var i=this;var e=this.manager_;var n=e.getOl3d().getCesiumScene();var a=n.camera;a.moveEnd.addEventListener(this.ngeoDebounce_(function(){var t;var e=a.positionCartographic;i.ngeoStateManager_.updateState((t={},t[d.Permalink3dParam.ENABLED]=true,t[d.Permalink3dParam.LON]=Cesium.Math.toDegrees(e.longitude).toFixed(5),t[d.Permalink3dParam.LAT]=Cesium.Math.toDegrees(e.latitude).toFixed(5),t[d.Permalink3dParam.ELEVATION]=e.height.toFixed(0),t[d.Permalink3dParam.HEADING]=Cesium.Math.toDegrees(a.heading).toFixed(3),t[d.Permalink3dParam.PITCH]=Cesium.Math.toDegrees(a.pitch).toFixed(3),t))},1e3,true));this.manager_.on("toggle",function(t){if(!t.target.is3dEnabled()){i.remove3dState_()}})};e.remove3dState_=function t(){var e=this;this.ngeoLocation_.getParamKeysWithPrefix(d.Permalink3dParam.PREFIX).forEach(function(t){e.ngeoStateManager_.deleteParam(t)})};return t}();var v="ngeoOlcsService";h.module=angular.module(v,[u["a"].name,m["a"].module.name,g["a"].module.name]).service(v,h);var f=h;var _=f;var p=i(72);var b=i(66);T.$inject=["$attrs","ngeoOlcsControls3dTemplateUrl"];var P=angular.module("ngeoOlcsControls3d",[]);function E(t,e){return Number.isFinite(e)&&(!Number.isFinite(t)||Math.abs(e-t)>.05)}var C=function(){t.$inject=["$element","ngeoOlcsService"];function t(t,e){this.element_=t;this.ol3dm;this.minTilt;this.maxTilt;this.tiltRightEl_;this.tiltLeftEl_;this.rotation3dEl_;this.angle3dEl_;this.previousRotation_;this.previousViewMatrix_;this.animationFrameRequestId_;this.olcsService_=e}var e=t.prototype;e.updateWidget_=function t(){var e=this;var i=this.ol3dm.getOl3d().getOlView().getRotation();if(E(this.previousRotation_,i)){this.rotateElement_(this.rotation3dEl_,i);this.previousRotation_=i}var n=this.ol3dm.getCesiumViewMatrix();if(!Cesium.Matrix4.equalsEpsilon(this.previousViewMatrix_,n,1e-5)){var a=this.ol3dm.getTiltOnGlobe();if(Number.isFinite(a||0)){this.rotateElement_(this.angle3dEl_,a);this.previousViewMatrix_=Cesium.Matrix4.clone(n);var o=.01;if(a-this.minTilt<o){this.tiltRightEl_.addClass("ngeo-right-inactive")}else if(this.tiltRightEl_.hasClass("ngeo-right-inactive")){this.tiltRightEl_.removeClass("ngeo-right-inactive")}if(this.maxTilt-a<o){this.tiltLeftEl_.addClass("ngeo-left-inactive")}else if(this.tiltLeftEl_.hasClass("ngeo-left-inactive")){this.tiltLeftEl_.removeClass("ngeo-left-inactive")}}}this.animationFrameRequestId_=requestAnimationFrame(function(){return e.updateWidget_()})};e.$onDestroy=function t(){if(this.animationFrameRequestId_){cancelAnimationFrame(this.animationFrameRequestId_)}};e.$onInit=function t(){if(this.minTilt===undefined){this.minTilt=0}if(this.maxTilt===undefined){this.maxTilt=7*Math.PI/16}if(!this.ol3dm){this.ol3dm=s["a"].assert(this.olcsService_.getManager())}this.tiltRightEl_=this.element_.find(".ngeo-tilt-right");this.tiltLeftEl_=this.element_.find(".ngeo-tilt-left");this.rotation3dEl_=this.element_.find(".ngeo-rotation3d");this.angle3dEl_=this.element_.find(".ngeo-angle3d");this.updateWidget_()};e.rotateElement_=function t(e,i){var n="rotate("+i+"rad)";e.css({"-moz-transform":n,"-webkit-transform":n,"-o-transform":n,"-ms-transform":n,transform:n})};e.rotate=function t(e){e=Cesium.Math.toRadians(e);this.ol3dm.setHeading(e)};e.tilt=function t(e){e=Cesium.Math.toRadians(e);var i=this.ol3dm.getTiltOnGlobe();if(i+e<this.minTilt){e=this.minTilt-i}else if(i+e>this.maxTilt){e=this.maxTilt-i}var n=this.ol3dm.getCesiumScene();b["a"].rotateAroundBottomCenter(n,e)};e.zoom=function t(e){var i=this.ol3dm.getOlView();var n=i.getResolution();var a=i.constrainResolution(n,e);if(i.getAnimating()){i.cancelAnimations()}i.animate({resolution:a,duration:250,easing:p["b"]})};return t}();function T(t,e){if(e){return e}var i=t["ngeoOlcsControls3dTemplateUrl"];return i?i:"ngeo/olsc/controls3d"}P.run(["$templateCache",function(t){t.put("ngeo/olsc/controls3d",i(533))}]);var M={bindings:{minTilt:"<?",maxTilt:"<?",ol3dm:"<?"},controller:C,templateUrl:T};P.component("ngeoOlcsControls3d",M);P.value("ngeoOlcsControls3dTemplateUrl","");var O=P;var x=angular.module("ngeoOlcsModule",[O.name,_.module.name]);var S=x;var y=S;var w=i(23);var I=i(337);function k(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;t.__proto__=e}var L=function(a){k(t,a);function t(t,e,i){var n;n=a.call(this,t,i)||this;n.rootScope_=e;return n}var e=t.prototype;e.toggle3d=function t(){var e=this;var i=a.prototype.toggle3d.call(this);return i.then(function(){e.rootScope_.$apply()})};return t}(I["a"]);var N=L;var R={};R.module=angular.module("app",["gettext",w["a"].name,y.name]);R.MainController=function(t,e){this.map=new a["a"]({layers:[new r["a"]({source:new l["b"]})],view:new o["a"]({center:[0,0],zoom:4})});var i="../node_modules/@camptocamp/cesium/Build/Cesium/Cesium.js";this.ol3dm=new N(i,t,{map:this.map});e.initialize(this.ol3dm)};R.MainController.$inject=["$rootScope","ngeoOlcsService"];R.module.controller("MainController",R.MainController);var j=e["default"]=R}});
//# sourceMappingURL=simple3d.cdba0c.js.map