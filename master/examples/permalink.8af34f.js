(function(l){function e(e){var t=e[0];var r=e[1];var n=e[2];var a,o,i=0,s=[];for(;i<t.length;i++){o=t[i];if(c[o]){s.push(c[o][0])}c[o]=0}for(a in r){if(Object.prototype.hasOwnProperty.call(r,a)){l[a]=r[a]}}if(f)f(e);while(s.length){s.shift()()}v.push.apply(v,n||[]);return u()}function u(){var e;for(var t=0;t<v.length;t++){var r=v[t];var n=true;for(var a=1;a<r.length;a++){var o=r[a];if(c[o]!==0)n=false}if(n){v.splice(t--,1);e=i(i.s=r[0])}}return e}var r={};var c={32:0};var v=[];function i(e){if(r[e]){return r[e].exports}var t=r[e]={i:e,l:false,exports:{}};l[e].call(t.exports,t,t.exports,i);t.l=true;return t.exports}i.m=l;i.c=r;i.d=function(e,t,r){if(!i.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:r})}};i.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};i.t=function(t,e){if(e&1)t=i(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var r=Object.create(null);i.r(r);Object.defineProperty(r,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r};i.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};i.d(e,"a",e);return e};i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};i.p="";var t=window["webpackJsonp"]=window["webpackJsonp"]||[];var n=t.push.bind(t);t.push=e;t=t.slice();for(var a=0;a<t.length;a++)e(t[a]);var f=n;v.push([500,0]);return u()})({500:function(e,t,r){r(51);r(52);e.exports=r(539)},501:function(e,t){},539:function(e,t,r){"use strict";r.r(t);var n=r(501);var g=r(1);var l=r(59);var a={LINE_STRING:"LineString",POINT:"Point",POLYGON:"Polygon"};var c=a;var s=r(101);var o=r(5);var h=r(15);var u=r(75);var i=r(9);var v=r(71);var f=r(307);var p=r(28);var d=r(38);var y=r(79);var _=r(105);var m=r(96);var S=r(27);var C=r(26);var w=r(73);var P=r(33);var b=r(34);var L=r(16);var M=r(120);var G=function e(t){f["a"].call(this);var r=t!==undefined?t:{};this.accuracy_=r.accuracy!==undefined?r.accuracy:e.ACCURACY_;this.encodeStyles_=r.encodeStyles!==undefined?r.encodeStyles:true;this.propertiesFunction_=r.properties!==undefined?r.properties:e.defaultPropertiesFunction_;this.setStyle_=r.setStyle!==undefined?r.setStyle:true;this.prevX_=0;this.prevY_=0;e.LegacyProperties_=r.propertiesType!==undefined&&r.propertiesType;this.defaultValues_=r.defaultValues!==undefined?r.defaultValues:{}};o["d"](G,f["a"]);G.StyleTypes_={LineString:c.LINE_STRING,Point:c.POINT,Polygon:c.POLYGON,MultiLineString:c.LINE_STRING,MultiPoint:c.POINT,MultiPolygon:c.POLYGON};G.LegacyProperties_={};G.prototype.readFeature;G.prototype.readFeatures;G.prototype.readGeometry;G.prototype.writeFeature;G.prototype.writeFeatures;G.prototype.writeGeometry;G.CHAR64_=".-_!*ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghjkmnpqrstuvwxyz";G.ACCURACY_=.1;G.defaultPropertiesFunction_=function(e){return e.getProperties()};G.encodeSignedNumber_=function(e){var t=e<<1;if(e<0){t=~t}return G.encodeNumber_(t)};G.encodeNumber_=function(e){var t="";while(e>=32){t+=G.CHAR64_.charAt(32|e&31);e>>=5}t+=G.CHAR64_.charAt(e);return t};G.encodeStyles_=function(e,t,r){var n=G.StyleTypes_[t];g["a"].assert(n!==undefined);for(var a=0;a<e.length;++a){var o=e[a];var i=o.getFill();var s=o.getImage();var l=o.getStroke();var u=o.getText();if(n==c.POLYGON){if(i!==null){G.encodeStylePolygon_(i,l,r)}}else if(n==c.LINE_STRING){if(l!==null){G.encodeStyleLine_(l,r)}}else if(n==c.POINT){if(s!==null){G.encodeStylePoint_(s,r)}}if(u!==null){G.encodeStyleText_(u,r)}}};G.encodeStyleLine_=function(e,t){G.encodeStyleStroke_(e,t)};G.encodeStylePoint_=function(e,t){if(e instanceof w["a"]){var r=e.getRadius();if(t.length>0){t.push("'")}t.push(encodeURIComponent("pointRadius*"+r));var n=e.getFill();if(n!==null){G.encodeStyleFill_(n,t)}var a=e.getStroke();if(a!==null){G.encodeStyleStroke_(a,t)}}};G.encodeStylePolygon_=function(e,t,r){G.encodeStyleFill_(e,r);if(t!==null){G.encodeStyleStroke_(t,r)}};G.encodeStyleFill_=function(e,t,r){var n=r!==undefined?r:"fillColor";var a=e.getColor();if(a!==null){g["a"].assert(Array.isArray(a),"only supporting fill colors");var o=u["a"](a);g["a"].assert(Array.isArray(o),"fill color must be an array");var i=s["a"].rgbArrayToHex(o);if(t.length>0){t.push("'")}t.push(encodeURIComponent(n+"*"+i))}};G.encodeStyleStroke_=function(e,t){var r=e.getColor();if(r!==null){g["a"].assert(Array.isArray(r));var n=u["a"](r);g["a"].assert(Array.isArray(n),"only supporting stroke colors");var a=s["a"].rgbArrayToHex(n);if(t.length>0){t.push("'")}t.push(encodeURIComponent("strokeColor*"+a))}var o=e.getWidth();if(o!==undefined){if(t.length>0){t.push("'")}t.push(encodeURIComponent("strokeWidth*"+o))}};G.encodeStyleText_=function(e,t){var r=e.getFont();if(r!==undefined){var n=r.split(" ");if(n.length>=3){if(t.length>0){t.push("'")}t.push(encodeURIComponent("fontSize*"+n[1]))}}var a=e.getFill();if(a!==null){G.encodeStyleFill_(a,t,"fontColor")}};G.readLineStringGeometry_=function(e){g["a"].assert(e.substring(0,2)==="l(");g["a"].assert(e[e.length-1]==")");e=e.substring(2,e.length-1);var t=this.decodeCoordinates_(e);return new d["a"](t,p["a"].XY)};G.readMultiLineStringGeometry_=function(e){g["a"].assert(e.substring(0,2)==="L(");g["a"].assert(e[e.length-1]==")");e=e.substring(2,e.length-1);var t=[];var r=[];var n=e.split("'");for(var a=0,o=n.length;a<o;++a){t=this.decodeCoordinates_(n[a],t);r[a]=t.length}return new y["a"](t,p["a"].XY,r)};G.readPointGeometry_=function(e){g["a"].assert(e.substring(0,2)==="p(");g["a"].assert(e[e.length-1]==")");e=e.substring(2,e.length-1);var t=this.decodeCoordinates_(e);g["a"].assert(t.length===2);return new S["a"](t,p["a"].XY)};G.readMultiPointGeometry_=function(e){g["a"].assert(e.substring(0,2)==="P(");g["a"].assert(e[e.length-1]==")");e=e.substring(2,e.length-1);var t=this.decodeCoordinates_(e);return new _["a"](t,p["a"].XY)};G.readPolygonGeometry_=function(e){g["a"].assert(e.substring(0,2)==="a(");g["a"].assert(e[e.length-1]==")");e=e.substring(2,e.length-1);var t=[];var r=[];var n=e.split("'");for(var a=0,o=n.length;a<o;++a){t=this.decodeCoordinates_(n[a],t);var i=t.length;if(a===0){t[i++]=t[0];t[i++]=t[1]}else{t[i++]=t[r[a-1]];t[i++]=t[r[a-1]+1]}r[a]=i}return new C["b"](t,p["a"].XY,r)};G.readMultiPolygonGeometry_=function(e){g["a"].assert(e.substring(0,2)==="A(");g["a"].assert(e[e.length-1]==")");e=e.substring(2,e.length-1);var t=[];var r=[];var n=e.split(")(");for(var a=0,o=n.length;a<o;++a){var i=n[a].split("'");var s=r[a]=[];for(var l=0,u=i.length;l<u;++l){t=this.decodeCoordinates_(i[l],t);var c=t.length;if(l===0){t[c++]=t[0];t[c++]=t[1]}else{t[c++]=t[s[l-1]];t[c++]=t[s[l-1]+1]}s[l]=c}}return new m["a"](t,p["a"].XY,r)};G.setStyleInFeature_=function(e,t){if(e==""){return}var r=G.getStyleProperties_(e,t);var n=r["fillColor"];var a=r["fontSize"];var o=r["fontColor"];var i=r["pointRadius"];var s=r["strokeColor"];var l=r["strokeWidth"];var u=null;if(n!==undefined){u=new P["a"]({color:n})}var c=null;if(s!==undefined&&l!==undefined){c=new b["a"]({color:s,width:l})}var v=null;if(i!==undefined){v=new w["a"]({radius:i,fill:u,stroke:c});u=c=null}var f=null;if(a!==undefined&&o!==undefined){f=new M["a"]({font:a+" sans-serif",fill:new P["a"]({color:o})})}var p=new L["c"]({fill:u,image:v,stroke:c,text:f});t.setStyle(p)};G.setStyleProperties_=function(e,t){var r=G.getStyleProperties_(e,t);var n=t.getGeometry();if(n instanceof S["a"]){if(r["isLabel"]||r[l["a"].IS_TEXT]){delete r["strokeColor"];delete r["fillColor"]}else{delete r["fontColor"];delete r["fontSize"]}}else{delete r["fontColor"];if(n instanceof d["a"]){delete r["fillColor"];delete r["fillOpacity"]}}if(r["fontSize"]){var a=parseFloat(r["fontSize"]);if(r["fontSize"].indexOf("px")!==-1){a=Math.round(a/1.333333)}r["fontSize"]=a}var o={};for(var i in r){var s=r[i];if(G.LegacyProperties_[i]){o[G.LegacyProperties_[i]]=s}else{o[i]=s}}t.setProperties(o)};G.castValue_=function(e,t){var r=[l["a"].ANGLE,l["a"].OPACITY,l["a"].SIZE,l["a"].STROKE,"pointRadius","strokeWidth"];var n=[l["a"].IS_CIRCLE,l["a"].IS_RECTANGLE,l["a"].IS_TEXT,l["a"].SHOW_MEASURE,l["a"].SHOW_LABEL,"isCircle","isRectangle","isLabel","showMeasure","showLabel"];if(i["f"](r,e)){return+t}else if(i["f"](n,e)){return t==="true"?true:false}else{return t}};G.getStyleProperties_=function(e,t){var r=e.split("'");var n={};for(var a=0;a<r.length;++a){var o=decodeURIComponent(r[a]);var i=o.split("*");g["a"].assert(i.length===2);var s=i[0];var l=i[1];n[s]=G.castValue_(s,l)}return n};G.writeLineStringGeometry_=function(e){g["a"].assertInstanceof(e,d["a"]);var t=e.getFlatCoordinates();var r=e.getStride();var n=t.length;return"l("+this.encodeCoordinates_(t,r,0,n)+")"};G.writeMultiLineStringGeometry_=function(e){g["a"].assertInstanceof(e,y["a"]);var t=e.getEnds();var r=t.length;var n=e.getFlatCoordinates();var a=e.getStride();var o=0;var i=["L("];for(var s=0;s<r;++s){var l=t[s];var u=this.encodeCoordinates_(n,a,o,l);if(s!==0){i.push("'")}i.push(u);o=l}i.push(")");return i.join("")};G.writePointGeometry_=function(e){g["a"].assertInstanceof(e,S["a"]);var t=e.getFlatCoordinates();var r=e.getStride();var n=t.length;return"p("+this.encodeCoordinates_(t,r,0,n)+")"};G.writeMultiPointGeometry_=function(e){g["a"].assertInstanceof(e,_["a"]);var t=e.getFlatCoordinates();var r=e.getStride();var n=t.length;return"P("+this.encodeCoordinates_(t,r,0,n)+")"};G.encodeRings_=function(e,t,r,n,a){var o=n.length;for(var i=0;i<o;++i){var s=n[i]-t;var l=this.encodeCoordinates_(e,t,r,s);if(i!==0){a.push("'")}a.push(l);r=n[i]}return r};G.writePolygonGeometry_=function(e){g["a"].assertInstanceof(e,C["b"]);var t=e.getFlatCoordinates();var r=e.getStride();var n=e.getEnds();var a=0;var o=["a("];G.encodeRings_.call(this,t,r,a,n,o);o.push(")");return o.join("")};G.writeMultiPolygonGeometry_=function(e){g["a"].assertInstanceof(e,m["a"]);var t=e.getFlatCoordinates();var r=e.getStride();var n=e.getEndss();var a=n.length;var o=0;var i=["A"];for(var s=0;s<a;++s){var l=n[s];i.push("(");o=G.encodeRings_.call(this,t,r,o,l,i);i.push(")")}return i.join("")};G.GEOMETRY_READERS_={P:G.readMultiPointGeometry_,L:G.readMultiLineStringGeometry_,A:G.readMultiPolygonGeometry_,l:G.readLineStringGeometry_,p:G.readPointGeometry_,a:G.readPolygonGeometry_};G.GEOMETRY_WRITERS_={MultiLineString:G.writeMultiLineStringGeometry_,MultiPoint:G.writeMultiPointGeometry_,MultiPolygon:G.writeMultiPolygonGeometry_,LineString:G.writeLineStringGeometry_,Point:G.writePointGeometry_,Polygon:G.writePolygonGeometry_};G.prototype.decodeCoordinates_=function(e,t){var r=e.length;var n=0;var a=t!==undefined?t:[];var o=a.length;while(n<r){var i=void 0;var s=0;var l=0;do{i=G.CHAR64_.indexOf(e.charAt(n++));l|=(i&31)<<s;s+=5}while(i>=32);var u=l&1?~(l>>1):l>>1;this.prevX_+=u;s=0;l=0;do{i=G.CHAR64_.indexOf(e.charAt(n++));l|=(i&31)<<s;s+=5}while(i>=32);var c=l&1?~(l>>1):l>>1;this.prevY_+=c;a[o++]=this.prevX_*this.accuracy_;a[o++]=this.prevY_*this.accuracy_}return a};G.prototype.encodeCoordinates_=function(e,t,r,n){var a="";for(var o=r;o<n;o+=t){var i=e[o];var s=e[o+1];i=Math.floor(i/this.accuracy_);s=Math.floor(s/this.accuracy_);var l=i-this.prevX_;var u=s-this.prevY_;this.prevX_=i;this.prevY_=s;a+=G.encodeSignedNumber_(l)+G.encodeSignedNumber_(u)}return a};G.prototype.readFeatureFromText=function(e,t){g["a"].assert(e.length>2);g["a"].assert(e[1]==="(");g["a"].assert(e[e.length-1]===")");var r=e.indexOf("~");var n=r>=0?e.substring(0,r)+")":e;var a=this.readGeometryFromText(n,t);var o=new h["a"](a);if(r>=0){var i=e.substring(r+1,e.length-1);r=i.indexOf("~");var s=r>=0?i.substring(0,r):i;if(s!=""){var l=s.split("'");for(var u=0;u<l.length;++u){var c=decodeURIComponent(l[u]);var v=c.split("*");g["a"].assert(v.length===2);var f=v[0];var p=v[1];if(!this.setStyle_&&G.LegacyProperties_[f]){f=G.LegacyProperties_[f]}o.set(f,G.castValue_(f,p))}}if(r>=0){var d=i.substring(r+1);if(this.setStyle_){G.setStyleInFeature_(d,o)}else{G.setStyleProperties_(d,o)}}}return o};G.prototype.readFeaturesFromText=function(e,t){var n=this;g["a"].assert(e[0]==="F");this.prevX_=0;this.prevY_=0;var r=[];e=e.substring(1);while(e.length>0){var a=e.indexOf(")");g["a"].assert(a>=0);var o=this.readFeatureFromText(e.substring(0,a+1),t);r.push(o);e=e.substring(a+1)}r.forEach(function(e){for(var t in n.defaultValues_){var r=G.LegacyProperties_[t];if(e.get(r)===undefined){e.set(r,n.defaultValues_[t].call(null,e))}}});return r};G.prototype.readGeometryFromText=function(e,t){var r=G.GEOMETRY_READERS_[e[0]];g["a"].assert(r!==undefined);return r.call(this,e)};G.prototype.writeFeatureText=function(e,t){var r=[];var n="";var a=e.getGeometry();if(a){n=this.writeGeometryText(a,t)}if(n.length>0){g["a"].assert(n[n.length-1]===")");n=n.substring(0,n.length-1);r.push(n)}var o=[];var i=this.propertiesFunction_(e);for(var s in i){var l=i[s];if(l!==undefined&&l!==null&&s!==e.getGeometryName()){if(o.length!==0){o.push("'")}var u=encodeURIComponent(s.replace(/[()'*]/g,"_")+"*"+l.toString().replace(/[()'*]/g,"_"));o.push(u)}}if(o.length>0){r.push("~");Array.prototype.push.apply(r,o)}if(this.encodeStyles_){var c=e.getStyleFunction();if(c!==undefined){var v=c.call(e,0);if(v!==null){var f=[];v=Array.isArray(v)?v:[v];G.encodeStyles_(v,a.getType(),f);if(f.length>0){r.push("~");Array.prototype.push.apply(r,f)}}}}r.push(")");return r.join("")};G.prototype.writeFeaturesText=function(e,t){this.prevX_=0;this.prevY_=0;var r=[];if(e.length>0){r.push("F");for(var n=0,a=e.length;n<a;++n){r.push(this.writeFeatureText(e[n],t))}}return r.join("")};G.prototype.writeGeometryText=function(e,t){var r=G.GEOMETRY_WRITERS_[e.getType()];g["a"].assert(r!==undefined);var n=v["b"](e,true,t);return r.call(this,n)};var T=G;var A=r(23);var F=r(141);var R=r(91);var I=r(287);var O=r(19);var x=r(70);var E=r(18);var N=r(41);var Y=r(30);var k=r(36);var j={};j.module=angular.module("app",["gettext",A["a"].name,F["a"].name,I["a"].name]);j.mapComponent={controller:"AppMapController as ctrl",bindings:{map:"=appMap"},template:"<div ngeo-map=ctrl.map></div>"};j.module.component("appMap",j.mapComponent);j.MapComponentController=function(e,t){this.map;this.ngeoLocation_=e;this.ngeoDebounce_=t};j.MapComponentController.$inject=["ngeoLocation","ngeoDebounce"];j.module.controller("AppMapController",j.MapComponentController);j.MapComponentController.prototype.$onInit=function(){var n=this;var a=this.map.getView();var e=this.ngeoLocation_.getParam("z");e=e!==undefined?+e:4;var t=this.ngeoLocation_.getParam("x");var r=this.ngeoLocation_.getParam("y");var o=t!==undefined&&r!==undefined?[+t,+r]:[0,0];a.setCenter(o);a.setZoom(e);this.ngeoLocation_.updateParams({z:e,x:Math.round(o[0]),y:Math.round(o[1])});a.on("propertychange",this.ngeoDebounce_(function(e){var t=a.getCenter();var r={z:a.getZoom(),x:Math.round(t[0]),y:Math.round(t[1])};n.ngeoLocation_.updateParams(r)},300,true))};j.drawComponent={controller:"AppDrawController as ctrl",bindings:{map:"=appDrawMap",layer:"=appDrawLayer"},template:"<label>Enable drawing:"+'<input type="checkbox" ng-model="ctrl.interaction.active" />'+"</label><br>"+'<button ng-click="ctrl.clearLayer()">Clear layer</button>'};j.module.component("appDraw",j.drawComponent);j.DrawComponentController=function(e,t){this.map;this.layer;this.ngeoLocation_=t;this.scope_=e;this.featureSeq_=0;this.interaction};j.DrawComponentController.$inject=["$scope","ngeoLocation"];j.DrawComponentController.prototype.$onInit=function(){var a=this;var o=this.layer.getSource();this.interaction=new x["a"]({type:"LineString",source:o});this.interaction.setActive(false);this.map.addInteraction(this.interaction);R["a"].interaction(this.interaction);this.interaction.on("drawend",function(e){e.feature.set("id",++this.featureSeq_)},this);var i=new T;o.on("addfeature",function(e){var t=e.feature;t.setStyle(new L["c"]({stroke:new b["a"]({color:[255,0,0,1],width:2})}));var r=o.getFeatures();var n=i.writeFeatures(r);a.scope_.$applyAsync(function(){a.ngeoLocation_.updateParams({features:n})})});var e=this.ngeoLocation_.getParam("features");if(e!==undefined){var t=i.readFeatures(e);this.featureSeq_=t.length;o.addFeatures(t)}};j.DrawComponentController.prototype.clearLayer=function(){this.layer.getSource().clear(true);this.featureSeq_=0;this.ngeoLocation_.deleteParam("features")};j.module.controller("AppDrawController",j.DrawComponentController);j.MainController=function(){this.map=new O["a"]({layers:[new E["a"]({source:new Y["b"]})]});var e=new k["a"];this.vectorLayer=new N["a"]({source:e});this.vectorLayer.setMap(this.map)};j.module.controller("MainController",j.MainController);var D=t["default"]=j}});
//# sourceMappingURL=permalink.8af34f.js.map