!function(l){function e(e){for(var t,r,n=e[0],o=e[1],a=e[2],i=0,s=[];i<n.length;i++)r=n[i],c[r]&&s.push(c[r][0]),c[r]=0;for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(l[t]=o[t]);for(d&&d(e);s.length;)s.shift()();return p.push.apply(p,a||[]),u()}function u(){for(var e,t=0;t<p.length;t++){for(var r=p[t],n=!0,o=1;o<r.length;o++){var a=r[o];0!==c[a]&&(n=!1)}n&&(p.splice(t--,1),e=i(i.s=r[0]))}return e}var r={},c={32:0},p=[];function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return l[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=l,i.c=r,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var t=window.webpackJsonp=window.webpackJsonp||[],n=t.push.bind(t);t.push=e,t=t.slice();for(var o=0;o<t.length;o++)e(t[o]);var d=n;p.push([498,0]),u()}({498:function(e,t,r){r(52),r(53),e.exports=r(537)},499:function(e,t){},537:function(e,t,r){"use strict";r.r(t);r(499);var h=r(1),l=r(59),c={LINE_STRING:"LineString",POINT:"Point",POLYGON:"Polygon"},s=r(102),n=r(20),f=r(15),u=r(79),o=r(8),a=r(71),i=r(306),p=r(29),d=r(40),g=r(81),y=r(106),_=r(98),v=r(28),m=r(27),S=r(73),C=r(35),P=r(36),w=r(14),b=r(119),L=function e(t){i.a.call(this);var r=void 0!==t?t:{};this.accuracy_=void 0!==r.accuracy?r.accuracy:e.ACCURACY_,this.encodeStyles_=void 0===r.encodeStyles||r.encodeStyles,this.propertiesFunction_=void 0!==r.properties?r.properties:e.defaultPropertiesFunction_,this.setStyle_=void 0===r.setStyle||r.setStyle,this.prevX_=0,this.prevY_=0,e.LegacyProperties_=void 0!==r.propertiesType&&r.propertiesType,this.defaultValues_=void 0!==r.defaultValues?r.defaultValues:{}};n.c(L,i.a),L.StyleTypes_={LineString:c.LINE_STRING,Point:c.POINT,Polygon:c.POLYGON,MultiLineString:c.LINE_STRING,MultiPoint:c.POINT,MultiPolygon:c.POLYGON},L.LegacyProperties_={},L.CHAR64_=".-_!*ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghjkmnpqrstuvwxyz",L.ACCURACY_=.1,L.defaultPropertiesFunction_=function(e){return e.getProperties()},L.encodeSignedNumber_=function(e){var t=e<<1;return e<0&&(t=~t),L.encodeNumber_(t)},L.encodeNumber_=function(e){for(var t="";32<=e;)t+=L.CHAR64_.charAt(32|31&e),e>>=5;return t+=L.CHAR64_.charAt(e)},L.encodeStyles_=function(e,t,r){var n=L.StyleTypes_[t];h.a.assert(void 0!==n);for(var o=0;o<e.length;++o){var a=e[o],i=a.getFill(),s=a.getImage(),l=a.getStroke(),u=a.getText();n==c.POLYGON?null!==i&&L.encodeStylePolygon_(i,l,r):n==c.LINE_STRING?null!==l&&L.encodeStyleLine_(l,r):n==c.POINT&&null!==s&&L.encodeStylePoint_(s,r),null!==u&&L.encodeStyleText_(u,r)}},L.encodeStyleLine_=function(e,t){L.encodeStyleStroke_(e,t)},L.encodeStylePoint_=function(e,t){if(e instanceof S.a){var r=e.getRadius();0<t.length&&t.push("'"),t.push(encodeURIComponent("pointRadius*"+r));var n=e.getFill();null!==n&&L.encodeStyleFill_(n,t);var o=e.getStroke();null!==o&&L.encodeStyleStroke_(o,t)}},L.encodeStylePolygon_=function(e,t,r){L.encodeStyleFill_(e,r),null!==t&&L.encodeStyleStroke_(t,r)},L.encodeStyleFill_=function(e,t,r){var n=void 0!==r?r:"fillColor",o=e.getColor();if(null!==o){h.a.assert(Array.isArray(o),"only supporting fill colors");var a=u.a(o);h.a.assert(Array.isArray(a),"fill color must be an array");var i=s.a.rgbArrayToHex(a);0<t.length&&t.push("'"),t.push(encodeURIComponent(n+"*"+i))}},L.encodeStyleStroke_=function(e,t){var r=e.getColor();if(null!==r){h.a.assert(Array.isArray(r));var n=u.a(r);h.a.assert(Array.isArray(n),"only supporting stroke colors");var o=s.a.rgbArrayToHex(n);0<t.length&&t.push("'"),t.push(encodeURIComponent("strokeColor*"+o))}var a=e.getWidth();void 0!==a&&(0<t.length&&t.push("'"),t.push(encodeURIComponent("strokeWidth*"+a)))},L.encodeStyleText_=function(e,t){var r=e.getFont();if(void 0!==r){var n=r.split(" ");3<=n.length&&(0<t.length&&t.push("'"),t.push(encodeURIComponent("fontSize*"+n[1])))}var o=e.getFill();null!==o&&L.encodeStyleFill_(o,t,"fontColor")},L.readLineStringGeometry_=function(e){h.a.assert("l("===e.substring(0,2)),h.a.assert(")"==e[e.length-1]),e=e.substring(2,e.length-1);var t=this.decodeCoordinates_(e);return new d.a(t,p.a.XY)},L.readMultiLineStringGeometry_=function(e){h.a.assert("L("===e.substring(0,2)),h.a.assert(")"==e[e.length-1]);for(var t=[],r=[],n=(e=e.substring(2,e.length-1)).split("'"),o=0,a=n.length;o<a;++o)t=this.decodeCoordinates_(n[o],t),r[o]=t.length;return new g.a(t,p.a.XY,r)},L.readPointGeometry_=function(e){h.a.assert("p("===e.substring(0,2)),h.a.assert(")"==e[e.length-1]),e=e.substring(2,e.length-1);var t=this.decodeCoordinates_(e);return h.a.assert(2===t.length),new v.a(t,p.a.XY)},L.readMultiPointGeometry_=function(e){h.a.assert("P("===e.substring(0,2)),h.a.assert(")"==e[e.length-1]),e=e.substring(2,e.length-1);var t=this.decodeCoordinates_(e);return new y.a(t,p.a.XY)},L.readPolygonGeometry_=function(e){h.a.assert("a("===e.substring(0,2)),h.a.assert(")"==e[e.length-1]);for(var t=[],r=[],n=(e=e.substring(2,e.length-1)).split("'"),o=0,a=n.length;o<a;++o){var i=(t=this.decodeCoordinates_(n[o],t)).length;t[i++]=0===o?(t[i++]=t[0],t[1]):(t[i++]=t[r[o-1]],t[r[o-1]+1]),r[o]=i}return new m.b(t,p.a.XY,r)},L.readMultiPolygonGeometry_=function(e){h.a.assert("A("===e.substring(0,2)),h.a.assert(")"==e[e.length-1]);for(var t=[],r=[],n=(e=e.substring(2,e.length-1)).split(")("),o=0,a=n.length;o<a;++o)for(var i=n[o].split("'"),s=r[o]=[],l=0,u=i.length;l<u;++l){var c=(t=this.decodeCoordinates_(i[l],t)).length;t[c++]=0===l?(t[c++]=t[0],t[1]):(t[c++]=t[s[l-1]],t[s[l-1]+1]),s[l]=c}return new _.a(t,p.a.XY,r)},L.setStyleInFeature_=function(e,t){if(""!=e){var r=L.getStyleProperties_(e,t),n=r.fillColor,o=r.fontSize,a=r.fontColor,i=r.pointRadius,s=r.strokeColor,l=r.strokeWidth,u=null;void 0!==n&&(u=new C.a({color:n}));var c=null;void 0!==s&&void 0!==l&&(c=new P.a({color:s,width:l}));var p=null;void 0!==i&&(p=new S.a({radius:i,fill:u,stroke:c}),u=c=null);var d=null;void 0!==o&&void 0!==a&&(d=new b.a({font:o+" sans-serif",fill:new C.a({color:a})}));var g=new w.c({fill:u,image:p,stroke:c,text:d});t.setStyle(g)}},L.setStyleProperties_=function(e,t){var r=L.getStyleProperties_(e,t),n=t.getGeometry();if(n instanceof v.a?r.isLabel||r[l.a.IS_TEXT]?(delete r.strokeColor,delete r.fillColor):(delete r.fontColor,delete r.fontSize):(delete r.fontColor,n instanceof d.a&&(delete r.fillColor,delete r.fillOpacity)),r.fontSize){var o=parseFloat(r.fontSize);-1!==r.fontSize.indexOf("px")&&(o=Math.round(o/1.333333)),r.fontSize=o}var a={};for(var i in r){var s=r[i];L.LegacyProperties_[i]?a[L.LegacyProperties_[i]]=s:a[i]=s}t.setProperties(a)},L.castValue_=function(e,t){var r=[l.a.ANGLE,l.a.OPACITY,l.a.SIZE,l.a.STROKE,"pointRadius","strokeWidth"],n=[l.a.IS_CIRCLE,l.a.IS_RECTANGLE,l.a.IS_TEXT,l.a.SHOW_MEASURE,l.a.SHOW_LABEL,"isCircle","isRectangle","isLabel","showMeasure","showLabel"];return o.f(r,e)?+t:o.f(n,e)?"true"===t:t},L.getStyleProperties_=function(e,t){for(var r=e.split("'"),n={},o=0;o<r.length;++o){var a=decodeURIComponent(r[o]).split("*");h.a.assert(2===a.length);var i=a[0],s=a[1];n[i]=L.castValue_(i,s)}return n},L.writeLineStringGeometry_=function(e){h.a.assertInstanceof(e,d.a);var t=e.getFlatCoordinates(),r=e.getStride(),n=t.length;return"l("+this.encodeCoordinates_(t,r,0,n)+")"},L.writeMultiLineStringGeometry_=function(e){h.a.assertInstanceof(e,g.a);for(var t=e.getEnds(),r=t.length,n=e.getFlatCoordinates(),o=e.getStride(),a=0,i=["L("],s=0;s<r;++s){var l=t[s],u=this.encodeCoordinates_(n,o,a,l);0!==s&&i.push("'"),i.push(u),a=l}return i.push(")"),i.join("")},L.writePointGeometry_=function(e){h.a.assertInstanceof(e,v.a);var t=e.getFlatCoordinates(),r=e.getStride(),n=t.length;return"p("+this.encodeCoordinates_(t,r,0,n)+")"},L.writeMultiPointGeometry_=function(e){h.a.assertInstanceof(e,y.a);var t=e.getFlatCoordinates(),r=e.getStride(),n=t.length;return"P("+this.encodeCoordinates_(t,r,0,n)+")"},L.encodeRings_=function(e,t,r,n,o){for(var a=n.length,i=0;i<a;++i){var s=n[i]-t,l=this.encodeCoordinates_(e,t,r,s);0!==i&&o.push("'"),o.push(l),r=n[i]}return r},L.writePolygonGeometry_=function(e){h.a.assertInstanceof(e,m.b);var t=e.getFlatCoordinates(),r=e.getStride(),n=e.getEnds(),o=["a("];return L.encodeRings_.call(this,t,r,0,n,o),o.push(")"),o.join("")},L.writeMultiPolygonGeometry_=function(e){h.a.assertInstanceof(e,_.a);for(var t=e.getFlatCoordinates(),r=e.getStride(),n=e.getEndss(),o=n.length,a=0,i=["A"],s=0;s<o;++s){var l=n[s];i.push("("),a=L.encodeRings_.call(this,t,r,a,l,i),i.push(")")}return i.join("")},L.GEOMETRY_READERS_={P:L.readMultiPointGeometry_,L:L.readMultiLineStringGeometry_,A:L.readMultiPolygonGeometry_,l:L.readLineStringGeometry_,p:L.readPointGeometry_,a:L.readPolygonGeometry_},L.GEOMETRY_WRITERS_={MultiLineString:L.writeMultiLineStringGeometry_,MultiPoint:L.writeMultiPointGeometry_,MultiPolygon:L.writeMultiPolygonGeometry_,LineString:L.writeLineStringGeometry_,Point:L.writePointGeometry_,Polygon:L.writePolygonGeometry_},L.prototype.decodeCoordinates_=function(e,t){for(var r=e.length,n=0,o=void 0!==t?t:[],a=o.length;n<r;){for(var i=void 0,s=0,l=0;l|=(31&(i=L.CHAR64_.indexOf(e.charAt(n++))))<<s,s+=5,32<=i;);var u=1&l?~(l>>1):l>>1;for(this.prevX_+=u,l=s=0;l|=(31&(i=L.CHAR64_.indexOf(e.charAt(n++))))<<s,s+=5,32<=i;);var c=1&l?~(l>>1):l>>1;this.prevY_+=c,o[a++]=this.prevX_*this.accuracy_,o[a++]=this.prevY_*this.accuracy_}return o},L.prototype.encodeCoordinates_=function(e,t,r,n){for(var o="",a=r;a<n;a+=t){var i=e[a],s=e[a+1];i=Math.floor(i/this.accuracy_),s=Math.floor(s/this.accuracy_);var l=i-this.prevX_,u=s-this.prevY_;this.prevX_=i,this.prevY_=s,o+=L.encodeSignedNumber_(l)+L.encodeSignedNumber_(u)}return o},L.prototype.readFeatureFromText=function(e,t){h.a.assert(2<e.length),h.a.assert("("===e[1]),h.a.assert(")"===e[e.length-1]);var r=e.indexOf("~"),n=0<=r?e.substring(0,r)+")":e,o=this.readGeometryFromText(n,t),a=new f.a(o);if(0<=r){var i=e.substring(r+1,e.length-1),s=0<=(r=i.indexOf("~"))?i.substring(0,r):i;if(""!=s)for(var l=s.split("'"),u=0;u<l.length;++u){var c=decodeURIComponent(l[u]).split("*");h.a.assert(2===c.length);var p=c[0],d=c[1];!this.setStyle_&&L.LegacyProperties_[p]&&(p=L.LegacyProperties_[p]),a.set(p,L.castValue_(p,d))}if(0<=r){var g=i.substring(r+1);this.setStyle_?L.setStyleInFeature_(g,a):L.setStyleProperties_(g,a)}}return a},L.prototype.readFeaturesFromText=function(e,t){var n=this;h.a.assert("F"===e[0]),this.prevX_=0,this.prevY_=0;var r=[];for(e=e.substring(1);0<e.length;){var o=e.indexOf(")");h.a.assert(0<=o);var a=this.readFeatureFromText(e.substring(0,o+1),t);r.push(a),e=e.substring(o+1)}return r.forEach(function(e){for(var t in n.defaultValues_){var r=L.LegacyProperties_[t];void 0===e.get(r)&&e.set(r,n.defaultValues_[t].call(null,e))}}),r},L.prototype.readGeometryFromText=function(e,t){var r=L.GEOMETRY_READERS_[e[0]];return h.a.assert(void 0!==r),r.call(this,e)},L.prototype.writeFeatureText=function(e,t){var r=[],n="",o=e.getGeometry();o&&(n=this.writeGeometryText(o,t)),0<n.length&&(h.a.assert(")"===n[n.length-1]),n=n.substring(0,n.length-1),r.push(n));var a=[],i=this.propertiesFunction_(e);for(var s in i){var l=i[s];if(null!=l&&s!==e.getGeometryName()){0!==a.length&&a.push("'");var u=encodeURIComponent(s.replace(/[()'*]/g,"_")+"*"+l.toString().replace(/[()'*]/g,"_"));a.push(u)}}if(0<a.length&&(r.push("~"),Array.prototype.push.apply(r,a)),this.encodeStyles_){var c=e.getStyleFunction();if(void 0!==c){var p=c.call(e,0);if(null!==p){var d=[];p=Array.isArray(p)?p:[p],L.encodeStyles_(p,o.getType(),d),0<d.length&&(r.push("~"),Array.prototype.push.apply(r,d))}}}return r.push(")"),r.join("")},L.prototype.writeFeaturesText=function(e,t){this.prevX_=0;var r=[];if((this.prevY_=0)<e.length){r.push("F");for(var n=0,o=e.length;n<o;++n)r.push(this.writeFeatureText(e[n],t))}return r.join("")},L.prototype.writeGeometryText=function(e,t){var r=L.GEOMETRY_WRITERS_[e.getType()];h.a.assert(void 0!==r);var n=a.b(e,!0,t);return r.call(this,n)};var M=L,G=r(19),T=r(141),A=r(93),R=r(285),I=r(18),F=r(70),O=r(17),x=r(42),E=r(31),N=r(37),Y={};Y.module=angular.module("app",["gettext",G.a.name,T.a.name,R.a.name]),Y.mapComponent={controller:"AppMapController as ctrl",bindings:{map:"=appMap"},template:"<div ngeo-map=ctrl.map></div>"},Y.module.component("appMap",Y.mapComponent),Y.MapComponentController=function(e,t){this.map,this.ngeoLocation_=e,this.ngeoDebounce_=t},Y.MapComponentController.$inject=["ngeoLocation","ngeoDebounce"],Y.module.controller("AppMapController",Y.MapComponentController),Y.MapComponentController.prototype.$onInit=function(){var n=this,o=this.map.getView(),e=this.ngeoLocation_.getParam("z");e=void 0!==e?+e:4;var t=this.ngeoLocation_.getParam("x"),r=this.ngeoLocation_.getParam("y"),a=void 0!==t&&void 0!==r?[+t,+r]:[0,0];o.setCenter(a),o.setZoom(e),this.ngeoLocation_.updateParams({z:e,x:Math.round(a[0]),y:Math.round(a[1])}),o.on("propertychange",this.ngeoDebounce_(function(e){var t=o.getCenter(),r={z:o.getZoom(),x:Math.round(t[0]),y:Math.round(t[1])};n.ngeoLocation_.updateParams(r)},300,!0))},Y.drawComponent={controller:"AppDrawController as ctrl",bindings:{map:"=appDrawMap",layer:"=appDrawLayer"},template:'<label>Enable drawing:<input type="checkbox" ng-model="ctrl.interaction.active" /></label><br><button ng-click="ctrl.clearLayer()">Clear layer</button>'},Y.module.component("appDraw",Y.drawComponent),Y.DrawComponentController=function(e,t){this.map,this.layer,this.ngeoLocation_=t,this.scope_=e,this.featureSeq_=0,this.interaction},Y.DrawComponentController.$inject=["$scope","ngeoLocation"],Y.DrawComponentController.prototype.$onInit=function(){var n=this,o=this.layer.getSource();this.interaction=new F.a({type:"LineString",source:o}),this.interaction.setActive(!1),this.map.addInteraction(this.interaction),A.a.interaction(this.interaction),this.interaction.on("drawend",function(e){e.feature.set("id",++this.featureSeq_)},this);var a=new M;o.on("addfeature",function(e){e.feature.setStyle(new w.c({stroke:new P.a({color:[255,0,0,1],width:2})}));var t=o.getFeatures(),r=a.writeFeatures(t);n.scope_.$applyAsync(function(){n.ngeoLocation_.updateParams({features:r})})});var e=this.ngeoLocation_.getParam("features");if(void 0!==e){var t=a.readFeatures(e);this.featureSeq_=t.length,o.addFeatures(t)}},Y.DrawComponentController.prototype.clearLayer=function(){this.layer.getSource().clear(!0),this.featureSeq_=0,this.ngeoLocation_.deleteParam("features")},Y.module.controller("AppDrawController",Y.DrawComponentController),Y.MainController=function(){this.map=new I.a({layers:[new O.a({source:new E.b})]});var e=new N.a;this.vectorLayer=new x.a({source:e}),this.vectorLayer.setMap(this.map)},Y.module.controller("MainController",Y.MainController);t.default=Y}});
//# sourceMappingURL=permalink.f0e4d4.js.map