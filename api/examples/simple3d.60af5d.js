!function(s){function t(t){for(var e,i,n=t[0],o=t[1],a=t[2],r=0,l=[];r<n.length;r++)i=n[r],m[i]&&l.push(m[i][0]),m[i]=0;for(e in o)Object.prototype.hasOwnProperty.call(o,e)&&(s[e]=o[e]);for(d&&d(t);l.length;)l.shift()();return c.push.apply(c,a||[]),u()}function u(){for(var t,e=0;e<c.length;e++){for(var i=c[e],n=!0,o=1;o<i.length;o++){var a=i[o];0!==m[a]&&(n=!1)}n&&(c.splice(e--,1),t=r(r.s=i[0]))}return t}var i={},m={41:0},c=[];function r(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return s[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=s,r.c=i,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var e=window.webpackJsonp=window.webpackJsonp||[],n=e.push.bind(e);e.push=t,e=e.slice();for(var o=0;o<e.length;o++)t(e[o]);var d=n;c.push([529,0]),u()}({529:function(t,e,i){i(52),i(53),t.exports=i(536)},530:function(t,e){},531:function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="ngeo-tools">\n  <div class="ngeo-angle"><div class="ngeo-angle3d"></div></div>\n  <button class="ngeo-left ngeo-tilt-left" ng-click="$ctrl.tilt(5)"></button>\n  <button class="ngeo-right ngeo-tilt-right" ng-click="$ctrl.tilt(-5)"></button>\n</div>\n<div class="ngeo-zoom">\n  <button class="ol-zoom-in" ng-click="$ctrl.zoom(1)"></button>\n  <button class="ol-zoom-out" ng-click="$ctrl.zoom(-1)"></button>\n</div>\n<div class="ngeo-tools">\n  <div class="ngeo-rotation"><div class="ngeo-rotation3d"></div></div>\n  <button class="ngeo-left" ng-click="$ctrl.rotate(-15)"></button>\n  <button class="ngeo-right" ng-click="$ctrl.rotate(15)"></button>\n</div>\n';return __p}},536:function(t,e,i){"use strict";i.r(e);i(530);var n=i(18),o=i(26),a=i(17),r=i(31),l=i(1),s=i(141),u=i(224),m={Permalink3dParam:{ENABLED:"3d_enabled",LON:"3d_lon",LAT:"3d_lat",ELEVATION:"3d_elevation",HEADING:"3d_heading",PITCH:"3d_pitch",PREFIX:"3d_"}},c=m,d=i(286),g=function(){function t(t,e,i){this.manager_,this.ngeoDebounce_=t,this.ngeoLocation_=e,this.ngeoStateManager_=i}t.$inject=["ngeoDebounce","ngeoLocation","ngeoStateManager"];var e=t.prototype;return e.initialize=function(t){var e=this;this.manager_=t,this.manager_.on("load",function(){e.cameraToState_()}),this.ngeoStateManager_.getInitialBooleanValue("3d_enabled")&&this.initialStateToCamera_()},e.getManager=function(){return this.manager_},e.initialStateToCamera_=function(){var t=this.ngeoStateManager_,e=t.getInitialNumberValue(c.Permalink3dParam.LON),i=t.getInitialNumberValue(c.Permalink3dParam.LAT),n=t.getInitialNumberValue(c.Permalink3dParam.ELEVATION),o=t.getInitialNumberValue(c.Permalink3dParam.HEADING)||0,a=t.getInitialNumberValue(c.Permalink3dParam.PITCH)||0;return l.a.assert(void 0!==e),l.a.assert(void 0!==i),l.a.assert(void 0!==n),this.manager_.set3dWithView(e,i,n,o,a)},e.cameraToState_=function(){var i=this,n=this.manager_.getOl3d().getCesiumScene().camera;n.moveEnd.addEventListener(this.ngeoDebounce_(function(){var t,e=n.positionCartographic;i.ngeoStateManager_.updateState(((t={})[c.Permalink3dParam.ENABLED]=!0,t[c.Permalink3dParam.LON]=Cesium.Math.toDegrees(e.longitude).toFixed(5),t[c.Permalink3dParam.LAT]=Cesium.Math.toDegrees(e.latitude).toFixed(5),t[c.Permalink3dParam.ELEVATION]=e.height.toFixed(0),t[c.Permalink3dParam.HEADING]=Cesium.Math.toDegrees(n.heading).toFixed(3),t[c.Permalink3dParam.PITCH]=Cesium.Math.toDegrees(n.pitch).toFixed(3),t))},1e3,!0)),this.manager_.on("toggle",function(t){t.target.is3dEnabled()||i.remove3dState_()})},e.remove3dState_=function(){var e=this;this.ngeoLocation_.getParamKeysWithPrefix(c.Permalink3dParam.PREFIX).forEach(function(t){e.ngeoStateManager_.deleteParam(t)})},t}(),h="ngeoOlcsService";g.module=angular.module(h,[s.a.name,u.a.module.name,d.a.module.name]).service(h,g);var f=g,_=i(72),v=i(65);P.$inject=["$attrs","ngeoOlcsControls3dTemplateUrl"];var p=angular.module("ngeoOlcsControls3d",[]);var b=function(){function t(t,e){this.element_=t,this.ol3dm,this.minTilt,this.maxTilt,this.tiltRightEl_,this.tiltLeftEl_,this.rotation3dEl_,this.angle3dEl_,this.previousRotation_,this.previousViewMatrix_,this.animationFrameRequestId_,this.olcsService_=e}t.$inject=["$element","ngeoOlcsService"];var e=t.prototype;return e.updateWidget_=function(){var t,e,i=this,n=this.ol3dm.getOl3d().getOlView().getRotation();t=this.previousRotation_,e=n,Number.isFinite(e)&&(!Number.isFinite(t)||.05<Math.abs(e-t))&&(this.rotateElement_(this.rotation3dEl_,n),this.previousRotation_=n);var o=this.ol3dm.getCesiumViewMatrix();if(!Cesium.Matrix4.equalsEpsilon(this.previousViewMatrix_,o,1e-5)){var a=this.ol3dm.getTiltOnGlobe();if(Number.isFinite(a||0)){this.rotateElement_(this.angle3dEl_,a),this.previousViewMatrix_=Cesium.Matrix4.clone(o);a-this.minTilt<.01?this.tiltRightEl_.addClass("ngeo-right-inactive"):this.tiltRightEl_.hasClass("ngeo-right-inactive")&&this.tiltRightEl_.removeClass("ngeo-right-inactive"),this.maxTilt-a<.01?this.tiltLeftEl_.addClass("ngeo-left-inactive"):this.tiltLeftEl_.hasClass("ngeo-left-inactive")&&this.tiltLeftEl_.removeClass("ngeo-left-inactive")}}this.animationFrameRequestId_=requestAnimationFrame(function(){return i.updateWidget_()})},e.$onDestroy=function(){this.animationFrameRequestId_&&cancelAnimationFrame(this.animationFrameRequestId_)},e.$onInit=function(){void 0===this.minTilt&&(this.minTilt=0),void 0===this.maxTilt&&(this.maxTilt=7*Math.PI/16),this.ol3dm||(this.ol3dm=l.a.assert(this.olcsService_.getManager())),this.tiltRightEl_=this.element_.find(".ngeo-tilt-right"),this.tiltLeftEl_=this.element_.find(".ngeo-tilt-left"),this.rotation3dEl_=this.element_.find(".ngeo-rotation3d"),this.angle3dEl_=this.element_.find(".ngeo-angle3d"),this.updateWidget_()},e.rotateElement_=function(t,e){var i="rotate("+e+"rad)";t.css({"-moz-transform":i,"-webkit-transform":i,"-o-transform":i,"-ms-transform":i,transform:i})},e.rotate=function(t){t=Cesium.Math.toRadians(t),this.ol3dm.setHeading(t)},e.tilt=function(t){t=Cesium.Math.toRadians(t);var e=this.ol3dm.getTiltOnGlobe();e+t<this.minTilt?t=this.minTilt-e:e+t>this.maxTilt&&(t=this.maxTilt-e);var i=this.ol3dm.getCesiumScene();v.a.rotateAroundBottomCenter(i,t)},e.zoom=function(t){var e=this.ol3dm.getOlView(),i=e.getResolution(),n=e.constrainResolution(i,t);e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:n,duration:250,easing:_.b})},t}();function P(t,e){if(e)return e;var i=t.ngeoOlcsControls3dTemplateUrl;return i||"ngeo/olsc/controls3d"}p.run(["$templateCache",function(t){t.put("ngeo/olsc/controls3d",i(531))}]);var E={bindings:{minTilt:"<?",maxTilt:"<?",ol3dm:"<?"},controller:b,templateUrl:P};p.component("ngeoOlcsControls3d",E),p.value("ngeoOlcsControls3dTemplateUrl","");var C=p,T=angular.module("ngeoOlcsModule",[C.name,f.module.name]),M=i(19);var O=function(o){var t,e;function i(t,e,i){var n;return(n=o.call(this,t,i)||this).rootScope_=e,n}return e=o,(t=i).prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e,i.prototype.toggle3d=function(){var t=this;return o.prototype.toggle3d.call(this).then(function(){t.rootScope_.$apply()})},i}(i(336).a),x={};x.module=angular.module("app",["gettext",M.a.name,T.name]),x.MainController=function(t,e){this.map=new n.a({layers:[new a.a({source:new r.b})],view:new o.a({center:[0,0],zoom:4})});this.ol3dm=new O("../node_modules/@camptocamp/cesium/Build/Cesium/Cesium.js",t,{map:this.map}),e.initialize(this.ol3dm)},x.MainController.$inject=["$rootScope","ngeoOlcsService"],x.module.controller("MainController",x.MainController);e.default=x}});
//# sourceMappingURL=simple3d.60af5d.js.map