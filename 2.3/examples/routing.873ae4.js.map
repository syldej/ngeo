{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/routing/NominatimService.js","webpack:///./src/routing/RoutingService.js","webpack:///./src/routing/NominatimInputComponent.js","webpack:///./src/routing/RoutingFeatureComponent.js","webpack:///./src/routing/RoutingComponent.js","webpack:///./src/routing/module.js","webpack:///./examples/routing.js","webpack:///./src/routing/routing.html","webpack:///./src/routing/routingfeature.html","webpack:///./src/routing/nominatiminput.html"],"names":["webpackJsonpCallback","data","chunkIds","moreModules","executeModules","moduleId","chunkId","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","6","exports","module","l","m","c","d","name","getter","o","defineProperty","configurable","enumerable","get","r","value","n","__esModule","getDefault","getModuleExports","object","property","p","jsonpArray","window","oldJsonpFunction","bind","slice","$http","$injector","ngeoDebounce","this","$http_","ngeoDebounce_","nominatimUrl_","has","substr","searchDefaultParams_","typeaheadDebounceDelay_","typeaheadSourceDebounced","typeaheadSource_","search","query","params","url","assign","options","_iterator","keys","_isArray","Array","isArray","_i","Symbol","iterator","_ref","next","done","option","join","reverse","coordinate","_iterator2","_isArray2","_i2","_ref2","syncResults","asyncResults","onSuccess_","resp","parse","lon","lat","display_name","map","onError_","then","angular","ngeoMiscDebounce","service","routingOptions_","ngeoOsrmBackendUrl_","backendUrl","protocolVersion_","getRoute","coordinates","config","coordinateString","getNearest","ngeoSearchSearchDirective","ngeoRoutingNominatimService","run","$templateCache","put","require","$attrs","templateUrl","undefined","ngeoRoutingNominatimInputComponentTemplateUrl","Controller","$element","$scope","ngeoNominatimService","element_","$scope_","onSelect","inputValue","datasets","display","source","listeners","select","select_","placeholder","event","suggestion","dataset","component","controller","bindings","ngeoRoutingNominatimInputComponent","ngeoRoutingFeatureTemplateUrl","$timeout","$q","scope_","timeout_","$q_","ngeoNominatimService_","feature","featureLabel","fillColor","strokeColor","onChange","vectorFeatures_","olCollection","vectorSource_","olSourceVector","features","vectorLayer_","olLayerVector","style","resolution","olStyleStyle","text","olStyleText","fill","olStyleFill","color","font","offsetY","stroke","olStyleStroke","width","modifyFeature_","olInteractionModify","draw_","onSelect_","errorMessage","$onInit","_this","addLayer","setActive","addInteraction","on","getArray","clear","snapFeature_","$watch","newVal","oldVal","onFeatureChange_","$onDestroy","removeLayer","removeInteraction","set","_this2","olInteractionDraw","type","removeFeature","setFeature_","label","transformedCoordinate","olProj","getView","getProjection","olFeature","geometry","olGeomPoint","_this3","addFeature","selected","parseFloat","newCoordinates","getGeometry","getCoordinates","setCenter","coord","getLonLatFromPoint_","onSuccess","onError","console","log","when","point","coords","projection","component_","ngeoMiscFilters","ngeoRoutingRoutingService","ngeoRoutingRoutingFeatureComponent","ngeoRoutingTemplateUrl","ngeoRoutingService","ngeoRoutingService_","routingProfiles","profiles","selectedRoutingProfile","calculateRoute","startFeature_","targetFeature_","viaArray","colors","start.fill","start.stroke","destination.fill","destination.stroke","via.fill","via.stroke","routeSource_","routeLayer_","routeDistance","routeDuration","regexIsFormattedCoord","debounceDelay","handleChange","clearRoute","reverseRoute","tmpFeature","parseRoute_","route","parsedRoutes","format","olFormatGeoJSON","formatConfig","dataProjection","featureProjection","legs","leg","steps","step","readGeometry","concat","coordFrom","coordTo","vias","filter","via","routes","addFeatures","fit","getExtent","parseInt","distance","duration","startRoute","getCoordinateAt","endRoute","startToRoute","routeToEnd","routeConnections","olGeomLineString","addVia","deleteVia","index","ngeoRoutingRoutingComponent","ngeoMapModule","ngeoRoutingModule","MainController","olMap","layers","olLayerTile","olSourceOSM","view","olView","center","zoom","routingfeatureActive"],"mappings":"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","file":"routing.873ae4.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t6: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([345,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/**\n * @module ngeo.routing.NominatimService\n */\nimport ngeoMiscDebounce from 'ngeo/misc/debounce.js';\n\n/**\n * Service to provide access to Nominatim, which allows to search for\n * OSM data by name and address.\n * @param {angular.$http} $http Angular http service.\n * @param {angular.$injector} $injector Main injector.\n * @param {ngeox.miscDebounce} ngeoDebounce ngeo Debounce service.\n * @constructor\n * @struct\n * @ngdoc service\n * @ngInject\n * @export\n * @ngname ngeoNominatimService\n * @see https://wiki.openstreetmap.org/wiki/Nominatim\n */\nconst exports = function($http, $injector, ngeoDebounce) {\n\n  /**\n   * @type {angular.$http}\n   * @private\n   */\n  this.$http_ = $http;\n\n  /**\n   * @type {ngeox.miscDebounce}\n   * @private\n   */\n  this.ngeoDebounce_ = ngeoDebounce;\n\n  /**\n   * URL for Nominatim backend\n   * Defaults openstreetmap instance.\n   * @type {string}\n   * @private\n   */\n  this.nominatimUrl_ = 'https://nominatim.openstreetmap.org/';\n\n  if ($injector.has('ngeoNominatimUrl')) {\n    this.nominatimUrl_ = $injector.get('ngeoNominatimUrl');\n\n    // the url is expected to end with a slash\n    if (this.nominatimUrl_.substr(-1) !== '/') {\n      this.nominatimUrl_ += '/';\n    }\n  }\n\n  /**\n   * @type {Object<string, string>}\n   * @private\n   */\n  this.searchDefaultParams_ = {};\n\n  if ($injector.has('ngeoNominatimSearchDefaultParams')) {\n    this.searchDefaultParams_ = $injector.get('ngeoNominatimSearchDefaultParams');\n  }\n\n  /**\n   * Delay (in milliseconds) to avoid calling the API too often.\n   * Only if there were no calls for that many milliseconds,\n   * the last call will be executed.\n   * @type {number}\n   * @private\n   */\n  this.typeaheadDebounceDelay_ = 500;\n\n  /**\n   * @export\n   * @type {function(string,function(Array.<BloodhoundDatum>),(function(Array.<ol.Feature>)|undefined))}\n   */\n  this.typeaheadSourceDebounced =\n    /** @type{function(string,function(Array.<BloodhoundDatum>),(function(Array.<ol.Feature>)|undefined))} */\n    (this.ngeoDebounce_(/** @type {function(?)} */ (this.typeaheadSource_.bind(this)), this.typeaheadDebounceDelay_, true));\n};\n\n/**\n * Search by name\n * @param {string} query Search query\n * @param {?Object} params Optional parameters\n * @return {!angular.$http.HttpPromise} promise of the Nominatim API request\n * @see https://wiki.openstreetmap.org/wiki/Nominatim#Search\n * @export\n */\nexports.prototype.search = function(query, params) {\n  let url = `${this.nominatimUrl_}search?q=${query}`;\n\n  params = params || {};\n  params = Object.assign({}, this.searchDefaultParams_, params);\n\n  // require JSON response\n  params['format'] = 'json';\n\n  if (params) {\n    url += '&';\n    const options = [];\n    for (const option of Object.keys(params)) {\n      options.push(`${option}=${params[option]}`);\n    }\n    url += options.join('&');\n  }\n\n  return this.$http_.get(url);\n};\n\n/**\n * Reverse Geocoding\n * @param {ol.Coordinate} coordinate Search coordinate in LonLat projection\n * @param {(Object|undefined)} params Optional parameters\n * @return {!angular.$http.HttpPromise} promise of the Nominatim API request\n * @see https://wiki.openstreetmap.org/wiki/Nominatim#Reverse_Geocoding\n * @export\n */\nexports.prototype.reverse = function(coordinate, params) {\n  let url = `${this.nominatimUrl_}reverse`;\n\n  params = Object.assign({}, params);\n\n  // coordinate\n  params['lon'] = coordinate[0];\n  params['lat'] = coordinate[1];\n\n  // require JSON response\n  params['format'] = 'json';\n\n  if (params) {\n    url += '?';\n    const options = [];\n    for (const option of Object.keys(params)) {\n      options.push(`${option}=${params[option]}`);\n    }\n    url += options.join('&');\n  }\n\n  return this.$http_.get(url);\n};\n\n/**\n * @param {string} query Search query\n * @param {function(Array.<BloodhoundDatum>)} syncResults Callback for synchronous execution, unused\n * @param {function(Array.<ngeox.NominatimSearchResult>)} asyncResults Callback for asynchronous execution\n * @private\n */\nexports.prototype.typeaheadSource_ = function(query, syncResults, asyncResults) {\n  const onSuccess_ = function(resp) {\n    /**\n     * Parses result response.\n     * @param {ngeox.NominatimSearchResponseResult} result Result\n     * @return {ngeox.NominatimSearchResult} Parsed result\n     */\n    const parse = function(result) {\n      return /** @type{ngeox.NominatimSearchResult} */({\n        coordinate: [result.lon, result.lat],\n        name: result.display_name\n      });\n    };\n    asyncResults(resp.data.map(parse));\n  };\n\n  const onError_ = function(resp) {\n    asyncResults([]);\n  };\n\n  this.search(query, {}).then(onSuccess_, onError_);\n};\n\n/**\n * @type {!angular.Module}\n */\nexports.module = angular.module('ngeoNominatimService', [\n  ngeoMiscDebounce.name\n]);\n\nexports.module.service('ngeoNominatimService', exports);\n\n\nexport default exports;\n","/**\n * @module ngeo.routing.RoutingService\n */\n/**\n * Service to provide access to a [Open Source Routing Machine (OSRM) backend](https://github.com/Project-OSRM/osrm-backend)\n * of version 5.8 and higher and its features.\n * @param {angular.$http} $http Angular http service.\n * @param {angular.$injector} $injector Main injector.\n * @constructor\n * @struct\n * @ngdoc service\n * @ngInject\n * @export\n * @ngname ngeoRoutingService\n */\nconst exports = function($http, $injector) {\n\n  /**\n   * @type {angular.$http}\n   * @private\n   */\n  this.$http_ = $http;\n\n  /**\n   * @type {ngeox.RoutingOptions}\n   * @private\n   */\n  this.routingOptions_ = $injector.has('ngeoRoutingOptions') ? $injector.get('ngeoRoutingOptions') : {};\n\n  /**\n   * URL for OSRM backend API.\n   * Defaults to demo backend.\n   * @type {string}\n   * @private\n   */\n  this.ngeoOsrmBackendUrl_ = this.routingOptions_.backendUrl || 'https://router.project-osrm.org/';\n\n  // the url is expected to end with a slash\n  if (this.ngeoOsrmBackendUrl_.substr(-1) !== '/') {\n    this.ngeoOsrmBackendUrl_ += '/';\n  }\n\n  /**\n   * Version of the protocol implemented by the service.\n   * see: https://github.com/Project-OSRM/osrm-backend/blob/master/docs/http.md\n   * @type {string}\n   * @private\n   */\n  this.protocolVersion_ = 'v1';\n\n};\n\n/**\n * Route request\n * @param {Array.<ol.Coordinate>} coordinates coordinates of the route (at least two!)\n * @param {?Object} config optional configuration\n * @return {!angular.$http.HttpPromise} promise of the OSRM API request\n */\nexports.prototype.getRoute = function(coordinates, config) {\n\n  config = config || {};\n\n  // Service\n  // see: https://github.com/Project-OSRM/osrm-backend/blob/master/docs/http.md#requests\n  if (!config['service']) {\n    config['service'] = 'route'; // default to route\n  }\n\n  // Mode of transportation,\n  // can be: car, bike, foot\n  // see: https://github.com/Project-OSRM/osrm-backend/blob/master/docs/http.md#requests\n  //\n  // As of version 5.8.0, OSRM (server) does not support multiple profiles simultaneously.\n  // This means the value actually does not matter.\n  if (!config['profile']) {\n    config['profile'] = 'car'; // default to car\n  }\n\n  // build request URL\n  let url = this.ngeoOsrmBackendUrl_;\n\n  // Common workaround to provide multiple profiles (since it is not supported yet)\n  // Every profile runs on its own instance.\n  if (config['instance']) {\n    url += `${config['instance']}/`;\n  }\n\n  url += `${config['service']}/${this.protocolVersion_}/${config['profile']}/`;\n\n  // [ [a,b] , [c,d] ] -> 'a,b;c,d'\n  const coordinateString = coordinates.map(c => c.join(',')).join(';');\n\n  url += coordinateString;\n\n  // look for route service options\n  // see: https://github.com/Project-OSRM/osrm-backend/blob/master/docs/http.md#route-service\n  if (config.options) {\n    url += '?';\n    const options = [];\n    for (const option of Object.keys(config.options)) {\n      options.push(`${option}=${config.options[option]}`);\n    }\n    url += options.join('&');\n  }\n\n  return this.$http_.get(url);\n};\n\n/**\n * Snaps a coordinate to the street network and returns the nearest match\n * @param {ol.Coordinate} coordinate coordinate to query\n * @param {?Object} config optional configuration\n * @return {!angular.$http.HttpPromise} promise of the OSRM API request\n * @see https://github.com/Project-OSRM/osrm-backend/blob/master/docs/http.md#nearest-service\n */\nexports.prototype.getNearest = function(coordinate, config) {\n  config = config || {};\n\n  // service is always nearest\n  config['service'] = 'nearest';\n\n  // Mode of transportation\n  // If used in combination with a getRoute request, choose the same profile.\n  if (!config['profile']) {\n    config['profile'] = 'car'; // default to car\n  }\n\n  // build request URL\n  let url = this.ngeoOsrmBackendUrl_;\n\n  // Common workaround to provide multiple profiles (since it is not supported yet)\n  // Every profile runs on its own instance.\n  if (config['instance']) {\n    url += `${config['instance']}/`;\n  }\n\n  url += `${config['service']}/${this.protocolVersion_}/${config['profile']}/`;\n\n  // [a,b] -> 'a,b'\n  const coordinateString = coordinate.join(',');\n  url += coordinateString;\n\n  // look for nearest service options\n  if (config.options) {\n    url += '?';\n    const options = [];\n    for (const option of Object.keys(config.options)) {\n      options.push(`${option}=${config.options[option]}`);\n    }\n    url += options.join('&');\n  }\n\n  return this.$http_.get(url);\n};\n\n\n/**\n * @type {!angular.Module}\n */\nexports.module = angular.module('ngeoRoutingService', [\n]);\n\nexports.module.service('ngeoRoutingService', exports);\n\n\nexport default exports;\n","/**\n * @module ngeo.routing.NominatimInputComponent\n */\nconst exports = {};\nimport ngeoSearchSearchDirective from 'ngeo/search/searchDirective.js';\nimport ngeoRoutingNominatimService from 'ngeo/routing/NominatimService.js';\n\n\n/**\n * @type {!angular.Module}\n */\nexports.module = angular.module('ngeoRoutingNominatimInputComponent', [\n  ngeoSearchSearchDirective.module.name,\n  ngeoRoutingNominatimService.module.name\n]);\n\nexports.module.run(/* @ngInject */ ($templateCache) => {\n  $templateCache.put('ngeo/routing/nominatiminput', require('./nominatiminput.html'));\n});\n\n\nexports.module.value('ngeoRoutingNominatimInputComponentTemplateUrl',\n  /**\n   * @param {!angular.Attributes} $attrs Attributes.\n   * @return {string} Template URL.\n   */\n  ($attrs) => {\n    const templateUrl = $attrs['ngeoRoutingNominatimInputComponentTemplateUrl'];\n    return templateUrl !== undefined ? templateUrl :\n      'ngeo/routing/nominatiminput';\n  }\n);\n\n\n/**\n * @param {!angular.Attributes} $attrs Attributes.\n * @param {!function(!angular.Attributes): string} ngeoRoutingNominatimInputComponentTemplateUrl Template function.\n * @return {string} Template URL.\n * @ngInject\n */\nfunction ngeoRoutingNominatimInputComponentTemplateUrl($attrs, ngeoRoutingNominatimInputComponentTemplateUrl) {\n  return ngeoRoutingNominatimInputComponentTemplateUrl($attrs);\n}\n\n\n/**\n * @param {!angular.JQLite} $element Element.\n * @param {angular.$injector} $injector Main injector.\n * @param {!angular.Scope} $scope Scope.\n * @param {!ngeo.routing.NominatimService} ngeoNominatimService service for Nominatim\n * @constructor\n * @private\n * @ngInject\n * @ngdoc controller\n * @ngname NgeoNominatimInputController\n */\nexports.Controller = function($element, $injector, $scope, ngeoNominatimService) {\n\n  /**\n   * @type {!angular.JQLite}\n   * @private\n   */\n  this.element_ = $element;\n\n  /**\n   * @type {angular.Scope}\n   * @private\n   */\n  this.$scope_ = $scope;\n\n  /**\n   * @type {ngeo.routing.NominatimService}\n   * @export\n   */\n  this.ngeoNominatimService = ngeoNominatimService;\n\n  /**\n   * @type {(function(Object)|undefined)}\n   * @export\n   */\n  this.onSelect;\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.inputValue;\n\n  /**\n   * @type {TypeaheadOptions}\n   * @export\n   */\n  this.options = /** @type {TypeaheadOptions} */ ({\n  });\n\n  /**\n   * @type {Array.<TypeaheadDataset>}\n   * @export\n   */\n  this.datasets = [/** @type {TypeaheadDataset} */({\n    name: 'nominatim',\n    display: 'name',\n    source: this.ngeoNominatimService.typeaheadSourceDebounced\n  })];\n\n  /**\n   * @type {ngeox.SearchDirectiveListeners}\n   * @export\n   */\n  this.listeners = /** @type {ngeox.SearchDirectiveListeners} */({\n    select: this.select_.bind(this)\n  });\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.placeholder = '';\n\n};\n\n/**\n * @param {jQuery.Event} event Event.\n * @param {ngeox.NominatimSearchResult} suggestion Suggestion.\n * @param {TypeaheadDataset} dataset Dataset.\n * @this {ngeo.routing.NominatimInputComponent.Controller}\n * @private\n */\nexports.Controller.prototype.select_ = function(event, suggestion, dataset) {\n  if (this.onSelect) {\n    this.onSelect(suggestion);\n  }\n};\n\n/**\n * Input form field which provides Nominatim typeahead lookup using {@link ngeo.routing.NominatimService}.\n *\n * Example:\n *\n *     <ngeo-nominatim-input\n *         ngeo-nominatim-input-value=\"ctrl.label\"\n *         ngeo-nominatim-input-placeholder=\"type to search\"\n *         ngeo-nominatim-input-on-select=\"ctrl.onSelect\">\n *\n * Is used in in the partial of {@link ngeo.routingFeatureComponent}.\n *\n * See the [../examples/routing.html](../examples/routing.html) example to see it in action.\n *\n * @htmlAttribute {function(ngeox.NominatimSearchResult)} ngeo-nominatim-input-on-select\n *  Event fired when user selects a new suggestion.\n * @htmlAttribute {string} ngeo-nominatim-input-value\n *  Value of input field, will be set to the label of the search result.\n * @htmlAttribute {string} ngeo-nominatim-input-placeholder\n *  Placeholder text, when field is empty.\n * @ngdoc directive\n * @ngname ngeoNominatimInput\n */\nconst component = {\n  controller: exports.Controller,\n  bindings: {\n    'onSelect': '=?ngeoNominatimInputOnSelect',\n    'inputValue': '=?ngeoNominatimInputValue',\n    'placeholder': '@?ngeoNominatimInputPlaceholder'\n  },\n  templateUrl: ngeoRoutingNominatimInputComponentTemplateUrl\n};\n\nexports.module.component('ngeoNominatimInput', component);\n\n\nexport default exports;\n","/**\n * @module ngeo.routing.RoutingFeatureComponent\n */\nconst exports = {};\nimport ngeoRoutingNominatimService from 'ngeo/routing/NominatimService.js';\nimport ngeoRoutingNominatimInputComponent from 'ngeo/routing/NominatimInputComponent.js';\nimport * as olProj from 'ol/proj.js';\nimport olFeature from 'ol/Feature.js';\nimport olCollection from 'ol/Collection.js';\nimport olSourceVector from 'ol/source/Vector.js';\nimport olLayerVector from 'ol/layer/Vector.js';\nimport olStyleStyle from 'ol/style/Style.js';\nimport olStyleText from 'ol/style/Text.js';\nimport olStyleFill from 'ol/style/Fill.js';\nimport olStyleStroke from 'ol/style/Stroke.js';\nimport olGeomPoint from 'ol/geom/Point.js';\nimport olInteractionModify from 'ol/interaction/Modify.js';\nimport olInteractionDraw from 'ol/interaction/Draw.js';\nimport 'font-awesome/css/font-awesome.css';\n\n\n/**\n * @type {!angular.Module}\n */\nexports.module = angular.module('ngeoRoutingFeatureComponent', [\n  ngeoRoutingNominatimService.module.name,\n  ngeoRoutingNominatimInputComponent.module.name\n]);\n\nexports.module.run(/* @ngInject */ ($templateCache) => {\n  $templateCache.put('ngeo/routing/routingfeature', require('./routingfeature.html'));\n});\n\n\nexports.module.value('ngeoRoutingFeatureTemplateUrl',\n  /**\n   * @param {!angular.Attributes} $attrs Attributes.\n   * @return {string} Template URL.\n   */\n  ($attrs) => {\n    const templateUrl = $attrs['ngeoRoutingFeatureTemplateUrl'];\n    return templateUrl !== undefined ? templateUrl :\n      'ngeo/routing/routingfeature';\n  }\n);\n\n/**\n * @param {!angular.Attributes} $attrs Attributes.\n * @param {!function(!angular.Attributes): string} ngeoRoutingFeatureTemplateUrl Template function.\n * @return {string} Template URL.\n * @ngInject\n */\nfunction ngeoRoutingFeatureTemplateUrl($attrs, ngeoRoutingFeatureTemplateUrl) {\n  return ngeoRoutingFeatureTemplateUrl($attrs);\n}\n\n\n/**\n * @param {!angular.Scope} $scope Angular scope.\n * @param {angular.$timeout} $timeout Angular timeout service.\n * @param {!angular.$q} $q Angular q service\n * @param {!ngeo.routing.NominatimService} ngeoNominatimService service for Nominatim\n * @constructor\n * @private\n * @ngInject\n * @ngdoc controller\n * @ngname NgeoRoutingFeatureController\n */\nexports.Controller = function($scope, $timeout, $q, ngeoNominatimService) {\n\n  /**\n   * @type {!angular.Scope}\n   * @private\n   */\n  this.scope_ = $scope;\n\n  /**\n   * @type {angular.$timeout}\n   * @private\n   */\n  this.timeout_ = $timeout;\n\n  /**\n   * @type {angular.$q}\n   * @private\n   */\n  this.$q_ = $q;\n\n  /**\n   * @type {ngeo.routing.NominatimService}\n   * @private\n   */\n  this.ngeoNominatimService_ = ngeoNominatimService;\n\n  /**\n   * @type {ol.Map}\n   * @private\n   */\n  this.map;\n\n  /**\n   * @type {ol.Feature}\n   * @export\n   */\n  this.feature;\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.featureLabel = '';\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.fillColor;\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.strokeColor;\n\n  /**\n   * @type {function(ol.Feature)}\n   * @export\n   */\n  this.onChange;\n\n  /**\n   * @type {ol.Collection}\n   * @private\n   */\n  this.vectorFeatures_ = new olCollection();\n\n  /**\n   * @type {ol.source.Vector}\n   * @private\n   */\n  this.vectorSource_ = new olSourceVector({\n    features: this.vectorFeatures_\n  });\n\n  /**\n   * @type {ol.layer.Vector}\n   * @private\n   */\n  this.vectorLayer_ = new olLayerVector({\n    source: this.vectorSource_,\n    style: (function(feature, resolution) {\n      return [new olStyleStyle({\n        text: new olStyleText({\n          fill: new olStyleFill({\n            color: this.fillColor || '#000000'\n          }),\n          font: 'normal 30px FontAwesome',\n          offsetY: -15,\n          stroke: new olStyleStroke({\n            width: 3,\n            color: this.strokeColor || '#000000'\n          }),\n          text: '\\uf041'\n        })\n      })];\n    }).bind(this)\n  });\n\n  /**\n   * Interaction for moving start and end.\n   * @type {ol.interaction.Modify}\n   * @private\n   */\n  this.modifyFeature_ = new olInteractionModify({\n    features: this.vectorFeatures_\n  });\n\n  /**\n   * @type {ol.interaction.Draw}\n   * @private\n   */\n  this.draw_ = null;\n\n  /**\n   * @param {ngeox.NominatimSearchResult} selected Selected result.\n   * @export\n   */\n  this.onSelect = this.onSelect_.bind(this);\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.errorMessage = '';\n};\n\nexports.Controller.prototype.$onInit = function() {\n  this.map.addLayer(this.vectorLayer_);\n\n  // setup modify interaction\n  this.modifyFeature_.setActive(true);\n  this.map.addInteraction(this.modifyFeature_);\n\n  this.modifyFeature_.on('modifyend', (event) => {\n    const feature = event.features.getArray()[0];\n    this.vectorSource_.clear();\n    this.snapFeature_(feature);\n  });\n\n  this.scope_.$watch(\n    () => this.feature,\n    (newVal, oldVal) => {\n      if (newVal) {\n        this.onFeatureChange_();\n      }\n      if (newVal === null) {\n        this.vectorSource_.clear();\n        this.featureLabel = '';\n      }\n    }\n  );\n};\n\n/**\n * Cleanup, mostly relevant for vias.\n */\nexports.Controller.prototype.$onDestroy = function() {\n  this.map.removeLayer(this.vectorLayer_);\n  this.modifyFeature_.setActive(false);\n  this.map.removeInteraction(this.modifyFeature_);\n};\n\n/**\n * @export\n */\nexports.Controller.prototype.set = function() {\n  if (this.draw_) {\n    this.map.removeInteraction(this.draw_);\n  }\n\n  this.draw_ = new olInteractionDraw({\n    features: this.vectorFeatures_,\n    type: /** @type {ol.geom.GeometryType} */ ('Point')\n  });\n\n  this.draw_.on('drawstart', () => {\n    if (this.feature) {\n      this.vectorSource_.removeFeature(this.feature);\n    }\n  });\n\n  this.draw_.on('drawend', (event) => {\n    if (this.draw_) {\n      this.map.removeInteraction(this.draw_);\n    }\n    this.snapFeature_(event.feature);\n    this.modifyFeature_.setActive(true);\n  });\n\n  this.modifyFeature_.setActive(false);\n  this.map.addInteraction(this.draw_);\n};\n\n/**\n * @param {ol.Coordinate} coordinate LonLat coordinate.\n * @param {string} label Feature name/label.\n * @private\n */\nexports.Controller.prototype.setFeature_ = function(coordinate, label) {\n  const transformedCoordinate = olProj.fromLonLat(coordinate, this.map.getView().getProjection());\n  if (label === '') {\n    label = transformedCoordinate.join('/');\n  }\n  this.feature = new olFeature({\n    geometry: new olGeomPoint(transformedCoordinate),\n    name: label\n  });\n};\n\nexports.Controller.prototype.onFeatureChange_ = function() {\n  // update label\n  this.featureLabel = /** @type{string} */(this.feature.get('name') || '');\n\n  //update vector source\n  this.vectorSource_.clear();\n  this.vectorSource_.addFeature(this.feature);\n\n  // notify others\n  if (this.onChange) {\n    this.timeout_(() => {\n      this.onChange(this.feature);\n    });\n  }\n};\n\n/**\n * @param {ngeox.NominatimSearchResult} selected Selected result.\n * @private\n */\nexports.Controller.prototype.onSelect_ = function(selected) {\n  const coordinate = selected.coordinate.map(parseFloat);\n  const label = selected.label;\n  this.setFeature_(coordinate, label);\n  const newCoordinates = /** @type{ol.geom.Point} */(this.feature.getGeometry()).getCoordinates();\n  this.map.getView().setCenter(newCoordinates);\n};\n\n/**\n * Snaps a feature to the street network using the getNearest\n * function of the routing service. Replaces the feature.\n * @param {ol.Feature} feature Feature to snap\n * @private\n */\nexports.Controller.prototype.snapFeature_ = function(feature) {\n  const coord = this.getLonLatFromPoint_(feature);\n  const config = {};\n\n  const onSuccess = (function(resp) {\n    const lon = parseFloat(resp['data']['lon']);\n    const lat = parseFloat(resp['data']['lat']);\n    const coordinate = [lon, lat];\n    const label = resp['data']['display_name'];\n    this.setFeature_(coordinate, label);\n  }).bind(this);\n\n  const onError = (function(resp) {\n    this.errorMessage = 'Error: nominatim server not responding.';\n    console.log(resp);\n  }).bind(this);\n\n  this.$q_.when(this.ngeoNominatimService_.reverse(coord, config))\n    .then(onSuccess.bind(this), onError.bind(this));\n};\n\n/**\n * Converts feature point into LonLat coordinate.\n * @param {ol.Feature} point Feature point to convert\n * @return {ol.Coordinate} LonLat coordinate\n * @private\n */\nexports.Controller.prototype.getLonLatFromPoint_ = function(point) {\n  const geometry = /** @type {ol.geom.Point} */ (point.getGeometry());\n  const coords = geometry.getCoordinates();\n  const projection = this.map.getView().getProjection();\n  return olProj.toLonLat(coords, projection);\n};\n\n\n/**\n * Provides a text input and draw interaction to allow a user to create and modify a ol.Feature (point geometry).\n *\n * The text input is provided by {@link ngeo.nominatimInputComponent} and includes Nominatim search.\n *\n * Example:\n *\n *     <ngeo-routing-feature\n *         ngeo-routing-feature-map=\"ctrl.map\"\n *         ngeo-routing-feature-feature=\"ctrl.feature\"\n *         ngeo-routing-feature-fill-color=\"#6BE62E\"\n *         ngeo-routing-feature-stroke-color=\"#4CB01E\"\n *         ngeo-routing-feature-on-change=\"ctrl.handleChange\">\n *\n * Is used in in the partial of {@link ngeo.routingComponent}.\n *\n * See the [../examples/routing.html](../examples/routing.html) example for a usage sample.\n *\n * @htmlAttribute {ol.Map} ngeo-routing-feature-map The map.\n * @htmlAttribute {ol.Feature} ngeo-routing-feature-feature The feature.\n * @htmlAttribute {string} ngeo-routing-feature-fill-color The marker fill color.\n * @htmlAttribute {string} ngeo-routing-feature-stroke-color The marker stroke color.\n * @htmlAttribute {function(ol.Feature)} ngeo-routing-feature-on-change Event fired when feature changes.\n * @ngdoc directive\n * @ngname ngeoRoutingFeature\n */\nexports.component_ = {\n  controller: exports.Controller,\n  bindings: {\n    'map': '<ngeoRoutingFeatureMap',\n    'feature': '=ngeoRoutingFeatureFeature',\n    'fillColor': '<?ngeoRoutingFeatureFillColor',\n    'strokeColor': '<?ngeoRoutingFeatureStrokeColor',\n    'onChange': '=?ngeoRoutingFeatureOnChange'\n  },\n  templateUrl: ngeoRoutingFeatureTemplateUrl\n};\n\nexports.module.component('ngeoRoutingFeature', exports.component_);\n\n\nexport default exports;\n","/**\n * @module ngeo.routing.RoutingComponent\n */\nconst exports = {};\nimport ngeoMiscDebounce from 'ngeo/misc/debounce.js';\nimport ngeoMiscFilters from 'ngeo/misc/filters.js';\nimport ngeoRoutingNominatimService from 'ngeo/routing/NominatimService.js';\nimport ngeoRoutingRoutingService from 'ngeo/routing/RoutingService.js';\nimport ngeoRoutingRoutingFeatureComponent from 'ngeo/routing/RoutingFeatureComponent.js';\nimport olFormatGeoJSON from 'ol/format/GeoJSON.js';\nimport olSourceVector from 'ol/source/Vector.js';\nimport olLayerVector from 'ol/layer/Vector.js';\nimport olStyleStyle from 'ol/style/Style.js';\nimport olStyleFill from 'ol/style/Fill.js';\nimport olStyleStroke from 'ol/style/Stroke.js';\nimport * as olProj from 'ol/proj.js';\nimport olFeature from 'ol/Feature.js';\nimport olGeomLineString from 'ol/geom/LineString.js';\nimport 'font-awesome/css/font-awesome.css';\n\nexports.module = angular.module('ngeoRoutingComponent', [\n  ngeoMiscDebounce.name,\n  ngeoMiscFilters.name,\n  ngeoRoutingNominatimService.module.name,\n  ngeoRoutingRoutingService.module.name,\n  ngeoRoutingRoutingFeatureComponent.module.name\n]);\n\n\nexports.module.run(/* @ngInject */ ($templateCache) => {\n  $templateCache.put('ngeo/routing/routing', require('./routing.html'));\n});\n\n\nexports.module.value('ngeoRoutingTemplateUrl',\n  /**\n   * @param {!angular.Attributes} $attrs Attributes.\n   * @return {string} Template URL.\n   */\n  ($attrs) => {\n    const templateUrl = $attrs['ngeoRoutingTemplateUrl'];\n    return templateUrl !== undefined ? templateUrl :\n      'ngeo/routing/routing';\n  }\n);\n\n\n/**\n * @param {!angular.Attributes} $attrs Attributes.\n * @param {!function(!angular.Attributes): string} ngeoRoutingTemplateUrl Template function.\n * @return {string} Template URL.\n * @ngInject\n */\nfunction ngeoRoutingTemplateUrl($attrs, ngeoRoutingTemplateUrl) {\n  return ngeoRoutingTemplateUrl($attrs);\n}\n\n\n/**\n * The controller for the routing directive.\n * @param {angular.$injector} $injector Main injector.\n * @param {!angular.Scope} $scope Scope.\n * @param {!ngeo.routing.RoutingService} ngeoRoutingService service for OSRM routing\n * @param {!ngeo.routing.NominatimService} ngeoNominatimService service for Nominatim\n * @param {!angular.$q} $q Angular q service\n * @param {ngeox.miscDebounce} ngeoDebounce ngeo Debounce service.\n * @constructor\n * @private\n * @ngInject\n * @ngdoc controller\n * @ngname NgeoRoutingController\n */\nexports.Controller = function($injector, $scope, ngeoRoutingService, ngeoNominatimService, $q, ngeoDebounce) {\n\n  /**\n   * @type {angular.Scope}\n   * @private\n   */\n  this.$scope_ = $scope;\n\n  /**\n   * @type {ngeo.routing.RoutingService}\n   * @private\n   */\n  this.ngeoRoutingService_ = ngeoRoutingService;\n\n  /**\n   * @type {ngeo.routing.NominatimService}\n   * @private\n   */\n  this.ngeoNominatimService_ = ngeoNominatimService;\n\n  /**\n   * @type {ngeox.RoutingOptions}\n   * @private\n   */\n  this.routingOptions_ = $injector.has('ngeoRoutingOptions') ? $injector.get('ngeoRoutingOptions') : {};\n\n  /**\n   * Available routing profiles.\n   * Example: [\n   *            {\n   *              label: 'Car', // used as label in the UI\n   *              profile: 'routed-car' // used as part of the query\n   *            }\n   *          ]\n   * @type {Array<ngeox.RoutingProfile>}\n   * @export\n   */\n  this.routingProfiles = this.routingOptions_.profiles || [];\n\n  /**\n   * @type {?ngeox.RoutingProfile}\n   * @export\n   */\n  this.selectedRoutingProfile = this.routingProfiles.length > 0 ? this.routingProfiles[0] : null;\n\n  $scope.$watch(\n    () => this.selectedRoutingProfile,\n    this.calculateRoute.bind(this)\n  );\n\n  /**\n   * @type {angular.$q}\n   * @private\n   */\n  this.$q_ = $q;\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map;\n\n  /**\n   * @type {string}\n   * @export\n   */\n  this.errorMessage = '';\n\n  /**\n   * @type {ol.Feature}\n   * @export\n   */\n  this.startFeature_ = null;\n\n  /**\n   * @type {ol.Feature}\n   * @export\n   */\n  this.targetFeature_ = null;\n\n  /**\n   * @type {Array.<ngeox.RoutingVia>}\n   * @export\n   */\n  this.viaArray = [];\n\n  /**\n   * @type {Object<string, string>}\n   * @export\n   */\n  this.colors = {\n    'start.fill': '#6BE62E',\n    'start.stroke': '#4CB01E',\n    'destination.fill': '#FF3E13',\n    'destination.stroke': '#CD3412',\n    'via.fill': '#767676',\n    'via.stroke': '#000000'\n  };\n\n  /**\n   * @type {ol.source.Vector}\n   * @private\n   */\n  this.routeSource_ = new olSourceVector({\n    features: []\n  });\n\n  /**\n   * @type {ol.layer.Vector}\n   * @private\n   */\n  this.routeLayer_ = new olLayerVector({\n    source: this.routeSource_,\n    style: new olStyleStyle({\n      fill: new olStyleFill({\n        color: 'rgba(16, 112, 29, 0.6)'\n      }),\n      stroke: new olStyleStroke({\n        color: 'rgba(16, 112, 29, 0.6)',\n        width: 5\n      })\n    })\n  });\n\n  /**\n   * Distance of route in meters\n   * @type {number}\n   * @export\n   */\n  this.routeDistance = 0;\n\n  /**\n   * Duration of route in minutes.\n   * @type {?number}\n   * @export\n   */\n  this.routeDuration = null;\n\n  /**\n   * @type {RegExp}\n   * @private\n   */\n  this.regexIsFormattedCoord = /\\d+\\.\\d+\\/\\d+\\.\\d+/;\n\n  /**\n   * @type {ol.interaction.Draw}\n   * @private\n   */\n  this.draw_ = null;\n\n  const debounceDelay = 200; // in milliseconds\n\n  /**\n   * Debounced because in some cases (reverse route) multiple changes are done\n   * at once and spam this function.\n   * @export\n   * @type {function()}\n   */\n  this.handleChange = /** @type {function()} */\n          (ngeoDebounce(\n            /** @type {function(?)} */ (this.calculateRoute.bind(this)),\n            debounceDelay,\n            true));\n};\n\n/**\n * Init the controller\n */\nexports.Controller.prototype.$onInit = function() {\n  this.map.addLayer(this.routeLayer_);\n};\n\n/**\n * Clears start, end and vias. Removes features from map.\n * @export\n */\nexports.Controller.prototype.clearRoute = function() {\n  this.startFeature_ = null;\n  this.targetFeature_ = null;\n  this.viaArray = [];\n  this.routeDistance = 0;\n  this.routeDuration = null;\n  this.routeSource_.clear();\n  this.errorMessage = '';\n};\n\n/**\n * Converts feature point into LonLat coordinate.\n * @param {ol.Feature} point Feature point to convert\n * @return {ol.Coordinate} LonLat coordinate\n * @private\n */\nexports.Controller.prototype.getLonLatFromPoint_ = function(point) {\n  const geometry = /** @type {ol.geom.Point} */ (point.getGeometry());\n  const coords = geometry.getCoordinates();\n  const projection = this.map.getView().getProjection();\n  return olProj.toLonLat(coords, projection);\n};\n\n/**\n * Flip start and target and re-calculate route.\n * @export\n */\nexports.Controller.prototype.reverseRoute = function() {\n  // swap start and target\n  const tmpFeature = this.startFeature_;\n  this.startFeature_ = this.targetFeature_;\n  this.targetFeature_ = tmpFeature;\n\n  // reverse vias\n  this.viaArray = this.viaArray.reverse();\n\n  // recalculation is done by the debounced handleChange\n};\n\n/**\n * @param {Object} route Routes of OSRM response\n * @returns {Array<ol.Feature>} parsed route features\n * @private\n */\nexports.Controller.prototype.parseRoute_ = function(route) {\n  let parsedRoutes = [];\n  const format = new olFormatGeoJSON();\n  const formatConfig = {\n    dataProjection: 'EPSG:4326',\n    featureProjection: this.map.getView().getProjection()\n  };\n  // if there are is useful \"legs\" data, parse this\n  if (route.legs) {\n    parsedRoutes = route.legs.map(leg => leg.steps.map(step => new olFeature({geometry: format.readGeometry(step.geometry, formatConfig)})));\n    // flatten\n    parsedRoutes = [].concat(...parsedRoutes);\n  } else if (route.geometry) {\n  // otherwise parse (overview) geometry\n    parsedRoutes.push(new olFeature({geometry: format.readGeometry(route.geometry, formatConfig)}));\n  }\n  return parsedRoutes;\n};\n\n/**\n * @export\n */\nexports.Controller.prototype.calculateRoute = function() {\n  if (this.startFeature_ && this.targetFeature_) {\n    // remove rendered routes\n    this.routeSource_.clear();\n\n    const coordFrom = this.getLonLatFromPoint_(this.startFeature_);\n    const coordTo = this.getLonLatFromPoint_(this.targetFeature_);\n    const vias = this.viaArray.filter(via => via.feature !== null).map(via => this.getLonLatFromPoint_(via.feature));\n    const route =  [coordFrom].concat(vias, [coordTo]);\n\n    const onSuccess_ = (function(resp) {\n      const features = this.parseRoute_(resp.data.routes[0]);\n      if (features.length === 0) {\n        console.log('No route or not supported format.');\n        return;\n      }\n      this.routeSource_.addFeatures(features);\n\n      // recenter map on route\n      this.map.getView().fit(this.routeSource_.getExtent());\n\n      this.routeDistance = parseInt(resp.data.routes[0].distance, 10);\n      this.routeDuration = resp.data.routes[0].duration;\n\n      // get first and last coordinate of route\n      const startRoute = /** @type{ol.geom.LineString} */(features[0].getGeometry()).getCoordinateAt(0);\n      const endRoute = /** @type{ol.geom.LineString} */(features[features.length - 1].getGeometry()).getCoordinateAt(1);\n\n      // build geometries to connect route to start and end point of query\n      const startToRoute = [/** @type {ol.geom.Point} */(this.startFeature_.getGeometry()).getCoordinates(), startRoute];\n      const routeToEnd = [endRoute, /** @type {ol.geom.Point} */(this.targetFeature_.getGeometry()).getCoordinates()];\n      const routeConnections = [\n        new olFeature(new olGeomLineString(startToRoute)),\n        new olFeature(new olGeomLineString(routeToEnd))\n      ];\n\n      // add them to the source\n      this.routeSource_.addFeatures(routeConnections);\n    }).bind(this);\n\n    const onError_ = (function(resp) {\n      this.errorMessage = 'Error: routing server not responding.';\n      console.log(resp);\n    }).bind(this);\n\n    const options = {};\n    options['steps'] = true;\n    options['overview'] = false;\n    options['geometries'] = 'geojson';\n\n    const config = {};\n    config['options'] = options;\n\n    if (this.selectedRoutingProfile) {\n      config['instance'] = this.selectedRoutingProfile['profile'];\n    }\n\n    this.$q_.when(this.ngeoRoutingService_.getRoute(route, config))\n      .then(onSuccess_.bind(this), onError_.bind(this));\n  }\n};\n\n/**\n * @export\n */\nexports.Controller.prototype.addVia = function() {\n  this.viaArray.push(/** @type{ngeox.RoutingVia} */({\n    feature: null,\n    onSelect: null\n  }));\n};\n\n/**\n * @param {number} index Array index.\n * @export\n */\nexports.Controller.prototype.deleteVia = function(index) {\n  if (this.viaArray.length > index) {\n    this.viaArray.splice(index, 1);\n    this.calculateRoute();\n  }\n};\n\n\nexports.module.component('ngeoRouting', {\n  controller: exports.Controller,\n  bindings: {\n    'map': '<ngeoRoutingMap'\n  },\n  templateUrl: ngeoRoutingTemplateUrl\n});\n\n\nexport default exports;\n","/**\n * @module ngeo.routing.module\n */\nimport ngeoRoutingRoutingComponent from 'ngeo/routing/RoutingComponent.js';\n\nimport './routing.less';\n\n/**\n * @type {angular.Module}\n */\nconst exports = angular.module('ngeoRoutingModule', [\n  ngeoRoutingRoutingComponent.module.name\n]);\n\n\nexport default exports;\n","/**\n * @module app.routing\n */\nconst exports = {};\n\n/**\n * This example shows the ngeo routing directive.\n */\nimport './routing.css';\nimport 'openlayers/css/ol.css';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport 'font-awesome/css/font-awesome.min.css';\n\nimport ngeoMapModule from 'ngeo/map/module.js';\nimport ngeoRoutingModule from 'ngeo/routing/module.js';\nimport olMap from 'ol/Map.js';\nimport olView from 'ol/View.js';\nimport olLayerTile from 'ol/layer/Tile.js';\nimport olSourceOSM from 'ol/source/OSM.js';\n\n/** @type {!angular.Module} **/\nexports.module = angular.module('app', [\n  'gettext',\n  ngeoMapModule.name,\n  ngeoRoutingModule.name\n]);\n\n\n/**\n * The application's main directive.\n * @constructor\n * @ngInject\n */\nexports.MainController = function() {\n\n  /**\n   * @type {ol.Map}\n   * @export\n   */\n  this.map = new olMap({\n    layers: [\n      new olLayerTile({\n        source: new olSourceOSM()\n      })\n    ],\n    view: new olView({\n      center: [931010.1535989442, 5961705.842297254],\n      zoom: 9\n    })\n  });\n\n  /**\n   * @type {boolean}\n   * @export\n   */\n  this.routingfeatureActive = true;\n};\n\nexports.module.controller('MainController', exports.MainController);\n\n\nexport default exports;\n","module.exports = \"<div class=ngeo-routing> <div class=\\\"ngeo-routing-start form-group\\\"> <ngeo-routing-feature ngeo-routing-feature-map=$ctrl.map ngeo-routing-feature-feature=$ctrl.startFeature_ ngeo-routing-feature-fill-color=\\\"$ctrl.colors['start.fill']\\\" ngeo-routing-feature-stroke-color=\\\"$ctrl.colors['start.stroke']\\\" ngeo-routing-feature-on-change=$ctrl.handleChange> </ngeo-routing-feature> </div> <div class=\\\"ngeo-routing-vias form-group\\\" ng-repeat=\\\"(index, via) in $ctrl.viaArray\\\"> <div class=form-inline> <div class=form-group> <ngeo-routing-feature ngeo-routing-feature-map=$ctrl.map ngeo-routing-feature-feature=via.feature ngeo-routing-feature-fill-color=\\\"$ctrl.colors['via.fill']\\\" ngeo-routing-feature-stroke-color=\\\"$ctrl.colors['via.stroke']\\\" ngeo-routing-feature-on-change=$ctrl.handleChange> </ngeo-routing-feature> </div> <button type=button class=\\\"btn btn-primary delete-via\\\" ng-click=$ctrl.deleteVia(index)> <span class=\\\"fa fa-trash-o\\\"></span> </button> </div> </div> <div class=\\\"ngeo-routing-destination form-group\\\"> <ngeo-routing-feature ngeo-routing-feature-map=$ctrl.map ngeo-routing-feature-feature=$ctrl.targetFeature_ ngeo-routing-feature-fill-color=\\\"$ctrl.colors['destination.fill']\\\" ngeo-routing-feature-stroke-color=\\\"$ctrl.colors['destination.stroke']\\\" ngeo-routing-feature-on-change=$ctrl.handleChange> </ngeo-routing-feature> </div> <div class=\\\"form-group pull-right\\\"> <button type=button class=\\\"btn btn-primary\\\" ng-click=$ctrl.clearRoute()> <span class=\\\"fa fa-trash-o\\\"></span> <span translate>Clear</span> </button> <button type=button class=\\\"btn btn-primary\\\" ng-click=$ctrl.reverseRoute()> <span class=\\\"fa fa-exchange\\\"></span> <span translate>Reverse</span> </button> <button type=button class=\\\"btn btn-primary\\\" ng-click=$ctrl.addVia()> <span class=\\\"fa fa-plus\\\"></span> <span translate>Add via</span> </button> </div> <div class=clearfix></div> <div class=form-horizontal ng-if=\\\"$ctrl.routingProfiles.length > 1\\\"> <div class=form-group> <label class=\\\"control-label col-md-4\\\" translate>Profile</label> <div class=col-md-8> <select class=form-control ng-model=$ctrl.selectedRoutingProfile> <option ng-repeat=\\\"profile in $ctrl.routingProfiles\\\" ng-value=profile>{{profile.label}}</option> </select> </div> </div> </div> <div class=\\\"ngeo-routing-error form-group clearfix\\\" ng-hide=\\\"$ctrl.errorMessage === ''\\\"> {{$ctrl.errorMessage}} </div> <div class=clearfix></div> <div class=form-horizontal ng-hide=\\\"$ctrl.routeDuration === null && $ctrl.routeDistance <= 0\\\"> <div class=row> <div class=col-md-12> <strong translate>Route statistics</strong> </div> </div> <div class=row ng-hide=\\\"$ctrl.routeDuration === null\\\"> <div class=\\\"col-md-4 text-right\\\" translate> Duration </div> <div class=col-md-8> {{$ctrl.routeDuration | ngeoDuration}} </div> </div> <div class=row ng-hide=\\\"$ctrl.routeDistance <= 0\\\"> <div class=\\\"col-md-4 text-right\\\" translate> Distance </div> <div class=col-md-8> {{$ctrl.routeDistance | ngeoUnitPrefix:'m'}} </div> </div> </div> </div> \";","module.exports = \"<div class=ngeo-routing-feature> <div class=input-group> <ngeo-nominatim-input ngeo-nominatim-input-value=$ctrl.featureLabel ngeo-nominatim-input-placeholder=\\\"{{'Search...' | translate}}\\\" ngeo-nominatim-input-on-select=$ctrl.onSelect> </ngeo-nominatim-input> <div class=\\\"input-group-addon btn\\\" ng-click=$ctrl.set()> <span class=\\\"fa fa-map-marker\\\"></span> </div> </div> </div> \";","module.exports = \"<div class=ngeo-nominatim-input> <input type=text class=form-control placeholder={{$ctrl.placeholder}} ng-model=$ctrl.inputValue ngeo-search=$ctrl.options ngeo-search-datasets=$ctrl.datasets ngeo-search-listeners=$ctrl.listeners> </div> \";"],"sourceRoot":""}